<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="19013" />

<meta name="date" content="2019-12-31" />

<title>Homework 19013</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework 19013</h1>
<h4 class="author">19013</h4>
<h4 class="date">2019-12-31</h4>



<div id="homework-1" class="section level1">
<h1>Homework 1</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, ﬁgures, tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="the-first-exampletext" class="section level3">
<h3>the first example(text)</h3>
<p>You can get many knowledge about R from this class.But you must spend a lot of time in it.In this way,you will get well command of R and maybe become an expert in R.</p>
</div>
<div id="the-second-examplefigure" class="section level3">
<h3>the second example(figure)</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">x&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">y&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">plot</span>(x,y)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAV1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmZmZmtv+QOgCQ2/+2ZgC2/7a2///bkDrb2//b/9vb////tmb/25D//7b//9v///+UBfVDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFjElEQVR4nO3d63LaRgBA4U3sJI1pS9TQWsa8/3MWkI0tW6tjll1phc/5kckwsBLf6ALo4rCz0cLcM1B7AkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkGZgcJimgso0zAffwOpU8j+xCmHC9lGGp1E3idOOFzINxRMI+cTX2pD+PIr33CxQRYJ1IRw9/Dzfrdd/Z1juEjLBWpu7nfNcenZ7P938XDRlroNOi43D98PQO3X371Rzt57wlwtcy+2Xd3t/338d1d6CZqgMqvY5nm56aguHW7OCm2kN93uqw2RbfSnB5p6uHIJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBJX60T6E7vf6Tf+4WOJwM1bosM+XX7vt6nYn0HCP6+OBw/XNvUCDPZ+y0Nzcb8oeei5fwSVoX3PrEjTYM8t2FQQabPN0zPlxLVDh6c6dQJBAkECQQJBAkECQQJBAkECQQJBAkECQQNAnAzr/p8zzgbarcHvmRC6ZbtbC+VNOWYIOx3Qi16jkn27OQsKkE1exi42uHagjivycmnW6OZsOqD0eOD0e+ErsmrdB+6106GTa9EXoqvdi0Wu9S0x37j7Z56DzK3To+eUQs8fFhoofL/TYfNfjGj5tf3agkeudk4abLzfSkECQQJBAkECQQJBAkEBQ3UAVfCWZFYjef8LvW9mbE4jef8ovpNmbEQjfv0AwrkA0rtsgGta92OzvH6v7c1AFCQQJBAkECQQVO+wzetjw0wNtnk8eamNnEdUENPppowjQ6aLeRdxPevzzaqFj86ejhoXvSJ4h+MbjEjQH0Omi5yVsg2YBOp0AEz1Hrx6gObZB0w93UdPvxaYfrlwCQUsGmuTDwoKBpvlBdrlAE/2kf4VAede86wPKvOYtF2g/xNCyknvNWzDQ0efdOAK9GeLtQAK9GeL1QMdVLtc26Gn9vSagJ5o8e7GPHfp9NzvZyvkeekNmms/TYEsGerOsCPShIQUaHzPbuNewDXo/aM4vGcvfi03TbECLaSaglOE/NAvZnnTuGxYo8/MLDC9QjlkQaKonCZRjoAueX2B4gXLMgkBTPakyoOUnECQQJBAkECQQJBAkECQQJBAkECQQJBBUDujhx+mCoDaExBvF9l4ZG+b1493FEkN3e0ycn2JA29Xpiql2PzdtklDvlbFheo8/fI9MJ3V+SgG1L9dtdldRNQl3zO+9MjZM//HYrZ6T56cQUBvuTrP68O1wEVXsD4+O1XtlbJj+45vh950+P+W2QS8zdFzqU+7i3XtlbJj+480fIXJb/sT5mQCoW91TNkK9V8aG6T2+XR0uZWuGhBLn58qA3kw6w/xc2yrWPfRt4J7Ftaxipz/NMc9GuntoaF9f70Z6yt189+bHV7EqdvOvZ2jSD4rH9z2+ka7jg+LTDHX3eN8kf9V4euX4ML0nNSEM3zU9cX78sgoJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkE1Q50OBFsu4r8DYYpqh3ocDpY7I94TFLtQLv26z9/pp18lafqgXbN4KUpk1U/UDt8Rt1UVQ/0uP4r4QTifFUPtLn5bz3jTqx6oMOf7Eo5ST9btQM1+118d+7uTNUONHsCQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJB/wM4Xe1KpbSQUAAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="the-third-exampletable" class="section level3">
<h3>the third example(table)</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(mtcars)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108.0</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258.0</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225.0</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Duster 360</td>
<td align="right">14.3</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">245</td>
<td align="right">3.21</td>
<td align="right">3.570</td>
<td align="right">15.84</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Merc 240D</td>
<td align="right">24.4</td>
<td align="right">4</td>
<td align="right">146.7</td>
<td align="right">62</td>
<td align="right">3.69</td>
<td align="right">3.190</td>
<td align="right">20.00</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td>Merc 230</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">140.8</td>
<td align="right">95</td>
<td align="right">3.92</td>
<td align="right">3.150</td>
<td align="right">22.90</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Merc 280</td>
<td align="right">19.2</td>
<td align="right">6</td>
<td align="right">167.6</td>
<td align="right">123</td>
<td align="right">3.92</td>
<td align="right">3.440</td>
<td align="right">18.30</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Merc 280C</td>
<td align="right">17.8</td>
<td align="right">6</td>
<td align="right">167.6</td>
<td align="right">123</td>
<td align="right">3.92</td>
<td align="right">3.440</td>
<td align="right">18.90</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Merc 450SE</td>
<td align="right">16.4</td>
<td align="right">8</td>
<td align="right">275.8</td>
<td align="right">180</td>
<td align="right">3.07</td>
<td align="right">4.070</td>
<td align="right">17.40</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td>Merc 450SL</td>
<td align="right">17.3</td>
<td align="right">8</td>
<td align="right">275.8</td>
<td align="right">180</td>
<td align="right">3.07</td>
<td align="right">3.730</td>
<td align="right">17.60</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td>Merc 450SLC</td>
<td align="right">15.2</td>
<td align="right">8</td>
<td align="right">275.8</td>
<td align="right">180</td>
<td align="right">3.07</td>
<td align="right">3.780</td>
<td align="right">18.00</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td>Cadillac Fleetwood</td>
<td align="right">10.4</td>
<td align="right">8</td>
<td align="right">472.0</td>
<td align="right">205</td>
<td align="right">2.93</td>
<td align="right">5.250</td>
<td align="right">17.98</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Lincoln Continental</td>
<td align="right">10.4</td>
<td align="right">8</td>
<td align="right">460.0</td>
<td align="right">215</td>
<td align="right">3.00</td>
<td align="right">5.424</td>
<td align="right">17.82</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Chrysler Imperial</td>
<td align="right">14.7</td>
<td align="right">8</td>
<td align="right">440.0</td>
<td align="right">230</td>
<td align="right">3.23</td>
<td align="right">5.345</td>
<td align="right">17.42</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Fiat 128</td>
<td align="right">32.4</td>
<td align="right">4</td>
<td align="right">78.7</td>
<td align="right">66</td>
<td align="right">4.08</td>
<td align="right">2.200</td>
<td align="right">19.47</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Honda Civic</td>
<td align="right">30.4</td>
<td align="right">4</td>
<td align="right">75.7</td>
<td align="right">52</td>
<td align="right">4.93</td>
<td align="right">1.615</td>
<td align="right">18.52</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Toyota Corolla</td>
<td align="right">33.9</td>
<td align="right">4</td>
<td align="right">71.1</td>
<td align="right">65</td>
<td align="right">4.22</td>
<td align="right">1.835</td>
<td align="right">19.90</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Toyota Corona</td>
<td align="right">21.5</td>
<td align="right">4</td>
<td align="right">120.1</td>
<td align="right">97</td>
<td align="right">3.70</td>
<td align="right">2.465</td>
<td align="right">20.01</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>Dodge Challenger</td>
<td align="right">15.5</td>
<td align="right">8</td>
<td align="right">318.0</td>
<td align="right">150</td>
<td align="right">2.76</td>
<td align="right">3.520</td>
<td align="right">16.87</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td>AMC Javelin</td>
<td align="right">15.2</td>
<td align="right">8</td>
<td align="right">304.0</td>
<td align="right">150</td>
<td align="right">3.15</td>
<td align="right">3.435</td>
<td align="right">17.30</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Camaro Z28</td>
<td align="right">13.3</td>
<td align="right">8</td>
<td align="right">350.0</td>
<td align="right">245</td>
<td align="right">3.73</td>
<td align="right">3.840</td>
<td align="right">15.41</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Pontiac Firebird</td>
<td align="right">19.2</td>
<td align="right">8</td>
<td align="right">400.0</td>
<td align="right">175</td>
<td align="right">3.08</td>
<td align="right">3.845</td>
<td align="right">17.05</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Fiat X1-9</td>
<td align="right">27.3</td>
<td align="right">4</td>
<td align="right">79.0</td>
<td align="right">66</td>
<td align="right">4.08</td>
<td align="right">1.935</td>
<td align="right">18.90</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Porsche 914-2</td>
<td align="right">26.0</td>
<td align="right">4</td>
<td align="right">120.3</td>
<td align="right">91</td>
<td align="right">4.43</td>
<td align="right">2.140</td>
<td align="right">16.70</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Lotus Europa</td>
<td align="right">30.4</td>
<td align="right">4</td>
<td align="right">95.1</td>
<td align="right">113</td>
<td align="right">3.77</td>
<td align="right">1.513</td>
<td align="right">16.90</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td>Ford Pantera L</td>
<td align="right">15.8</td>
<td align="right">8</td>
<td align="right">351.0</td>
<td align="right">264</td>
<td align="right">4.22</td>
<td align="right">3.170</td>
<td align="right">14.50</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Ferrari Dino</td>
<td align="right">19.7</td>
<td align="right">6</td>
<td align="right">145.0</td>
<td align="right">175</td>
<td align="right">3.62</td>
<td align="right">2.770</td>
<td align="right">15.50</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td>Maserati Bora</td>
<td align="right">15.0</td>
<td align="right">8</td>
<td align="right">301.0</td>
<td align="right">335</td>
<td align="right">3.54</td>
<td align="right">3.570</td>
<td align="right">14.60</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td>Volvo 142E</td>
<td align="right">21.4</td>
<td align="right">4</td>
<td align="right">121.0</td>
<td align="right">109</td>
<td align="right">4.11</td>
<td align="right">2.780</td>
<td align="right">18.60</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td>the data from R</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="homework-2" class="section level1">
<h1>Homework 2</h1>
<div id="the-first-question" class="section level2">
<h2>the first question</h2>
<p>if <span class="math inline">\(x\)</span>~<span class="math inline">\(exp(\lambda)\)</span>, we can get the pdf of <span class="math inline">\(y=sqrt(x)\)</span> is <span class="math inline">\(f(y)=2\lambda y e^{-\lambda y^{2}}\)</span></br> we can choose <span class="math inline">\(\sigma=1、0.5、2\)</span> to check whether the mode of generated samples is closed to the theoretical mode <span class="math inline">\(\sigma\)</span></br> when <span class="math inline">\(\sigma=1\)</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span> </a>
<a class="sourceLine" id="cb3-3" title="3">u &lt;-<span class="st"> </span><span class="kw">rexp</span>(n,<span class="dt">rate=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-4" title="4">x &lt;-<span class="st"> </span>u<span class="op">^</span>{<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>} <span class="co"># </span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">2</span><span class="op">*</span>xe<span class="op">^</span>{<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>})) </a>
<a class="sourceLine" id="cb3-6" title="6">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="fl">.001</span>) </a>
<a class="sourceLine" id="cb3-7" title="7"><span class="kw">lines</span>(y, <span class="dv">2</span><span class="op">*</span>y<span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>{<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span>})</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> when <span class="math inline">\(\sigma=0.5\)</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span> </a>
<a class="sourceLine" id="cb4-3" title="3">u &lt;-<span class="st"> </span><span class="kw">rexp</span>(n,<span class="dt">rate=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-4" title="4">x &lt;-<span class="st"> </span>u<span class="op">^</span>{<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>} <span class="co"># </span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">4</span><span class="op">*</span>xe<span class="op">^</span>{<span class="op">-</span><span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>})) </a>
<a class="sourceLine" id="cb4-6" title="6">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="fl">.001</span>) </a>
<a class="sourceLine" id="cb4-7" title="7"><span class="kw">lines</span>(y, <span class="dv">4</span><span class="op">*</span>y<span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>{<span class="op">-</span><span class="dv">2</span><span class="op">*</span>y<span class="op">^</span><span class="dv">2</span>})</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>when <span class="math inline">\(\sigma=2\)</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span> </a>
<a class="sourceLine" id="cb5-3" title="3">u &lt;-<span class="st"> </span><span class="kw">rexp</span>(n,<span class="dt">rate=</span><span class="dv">1</span><span class="op">/</span><span class="dv">8</span>)</a>
<a class="sourceLine" id="cb5-4" title="4">x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(u) <span class="co"># </span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>xe<span class="op">^</span>{<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">8</span>)<span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>})) </a>
<a class="sourceLine" id="cb5-6" title="6">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">.001</span>) </a>
<a class="sourceLine" id="cb5-7" title="7"><span class="kw">lines</span>(y, (<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>y<span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>{<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">8</span>)<span class="op">*</span>y<span class="op">^</span><span class="dv">2</span>})</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="the-sencond-question" class="section level2">
<h2>the sencond question</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">n &lt;-<span class="st"> </span><span class="fl">1e4</span> </a>
<a class="sourceLine" id="cb6-2" title="2">X1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-3" title="3">X2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean =</span> <span class="dv">3</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-4" title="4">r1 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.75</span>,<span class="fl">0.25</span>)) </a>
<a class="sourceLine" id="cb6-5" title="5">r2 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>)) </a>
<a class="sourceLine" id="cb6-6" title="6">r3 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>)) </a>
<a class="sourceLine" id="cb6-7" title="7">r4 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)) </a>
<a class="sourceLine" id="cb6-8" title="8"></a>
<a class="sourceLine" id="cb6-9" title="9">Z1 &lt;-<span class="st"> </span>r1<span class="op">*</span>X1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r1)<span class="op">*</span>X2</a>
<a class="sourceLine" id="cb6-10" title="10">Z2 &lt;-<span class="st"> </span>r2<span class="op">*</span>X1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r2)<span class="op">*</span>X2</a>
<a class="sourceLine" id="cb6-11" title="11">Z3 &lt;-<span class="st"> </span>r3<span class="op">*</span>X1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r3)<span class="op">*</span>X2</a>
<a class="sourceLine" id="cb6-12" title="12">Z4 &lt;-<span class="st"> </span>r4<span class="op">*</span>X1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r4)<span class="op">*</span>X2</a>
<a class="sourceLine" id="cb6-13" title="13"></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="kw">hist</span>(Z1);<span class="kw">hist</span>(Z2);<span class="kw">hist</span>(Z3);<span class="kw">hist</span>(Z4)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="homework-3" class="section level1">
<h1>Homework 3</h1>
<div id="section" class="section level2">
<h2>5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{π/3} sin t dt\]</span> and compare your estimate with the exact value of the integral.</p>
<div id="my-solution" class="section level3">
<h3>My solution</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">m&lt;-<span class="fl">1e4</span>;t&lt;-<span class="kw">runif</span>(m,<span class="dt">min =</span> <span class="dv">0</span>,<span class="dt">max =</span> pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb7-3" title="3">theta.hat&lt;-<span class="kw">mean</span>(pi<span class="op">*</span><span class="kw">sin</span>(t)<span class="op">/</span><span class="dv">3</span>)<span class="co">#the Monte Carlo estimate</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] 0.5009124 0.5000000</code></pre>
<p>From the result, we can get the MC estimate is 0.5009124, which is very close to the exact value of the integral.</p>
</div>
</div>
<div id="section-1" class="section level2">
<h2>5.10</h2>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math display">\[\int_{0}^{1} \frac{e^{-x}}{1+x^2} dx\]</span> and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
<div id="my-solution-1" class="section level3">
<h3>My solution</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">m&lt;-<span class="fl">1e4</span>;x&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb9-3" title="3">theta1&lt;-<span class="kw">mean</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))<span class="co">#the MC estimator of integration</span></a>
<a class="sourceLine" id="cb9-4" title="4">u&lt;-<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-5" title="5">g&lt;-.<span class="dv">5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>u)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>.<span class="dv">5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-6" title="6">theta2&lt;-<span class="kw">mean</span>(g)<span class="co">#the Antithetic variables estimator of integration</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="kw">print</span>(<span class="kw">c</span>(theta1,theta2))</a></code></pre></div>
<pre><code>## [1] 0.5252884 0.5247389</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">MC1&lt;-<span class="kw">sd</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(m)<span class="co">#sd estimate of MC</span></a>
<a class="sourceLine" id="cb11-2" title="2">MC2&lt;-<span class="kw">sd</span>(g)<span class="op">/</span><span class="kw">sqrt</span>(m<span class="op">/</span><span class="dv">2</span>)<span class="co">#sd eatimate of Antithetic</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw">cat</span>(<span class="st">&quot;the variance of MC estimate=&quot;</span>,MC1<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## the variance of MC estimate= 6.077993e-06</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">cat</span>(<span class="st">&quot;the variance of Antithetic estimate=&quot;</span>,MC2<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## the variance of Antithetic estimate= 2.179475e-07</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">cat</span>(<span class="st">&quot;the approximate reduction in variance =&quot;</span>,(MC1<span class="op">^</span><span class="dv">2</span><span class="op">-</span>MC2<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>MC1<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## the approximate reduction in variance = 0.9641415</code></pre>
<p>From the result,we can find the approximate reduction in variance is about 96.4%.</p>
</div>
</div>
<div id="section-2" class="section level2">
<h2>5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
<div id="my-solution-2" class="section level3">
<h3>My solution</h3>
<p>If <span class="math inline">\(x=-log(1-u*(1-e^{-1}))\)</span> is belongs to <span class="math inline">\((a,b)\)</span>, we can get <span class="math inline">\(x\)</span> when <span class="math inline">\(U \sim U(\frac{1-e^{-a}}{1-e^{-1}},\frac{1-e^{-b}}{1-e^{-1}})\)</span></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co">##importance sampling estimate </span></a>
<a class="sourceLine" id="cb17-2" title="2">M &lt;-<span class="st"> </span><span class="dv">50000</span></a>
<a class="sourceLine" id="cb17-3" title="3">g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb17-4" title="4">  <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-5" title="5">}</a>
<a class="sourceLine" id="cb17-6" title="6">u &lt;-<span class="st"> </span><span class="kw">runif</span>(M) </a>
<a class="sourceLine" id="cb17-7" title="7">x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb17-8" title="8">fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb17-9" title="9">theta0 &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb17-10" title="10">se0 &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)<span class="co">#sd of importance sampling estimate </span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="kw">cat</span>(<span class="st">&quot;se of importance sampling estimate=&quot;</span>,se0)</a></code></pre></div>
<pre><code>## se of importance sampling estimate= 0.09693489</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">cat</span>(<span class="st">&quot;variance estimate of ISE=&quot;</span>,se0<span class="op">^</span><span class="dv">2</span><span class="op">/</span>M)</a></code></pre></div>
<pre><code>## variance estimate of ISE= 1.879275e-07</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co">##stratified importance sampling estimate </span></a>
<a class="sourceLine" id="cb21-2" title="2">theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb21-3" title="3">k&lt;-<span class="dv">5</span>;m&lt;-M<span class="op">/</span>k</a>
<a class="sourceLine" id="cb21-4" title="4"></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="kw">set.seed</span>(<span class="dv">524</span>)</a>
<a class="sourceLine" id="cb21-6" title="6">g1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb21-7" title="7">  <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb21-8" title="8">}</a>
<a class="sourceLine" id="cb21-9" title="9">u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(m,<span class="dv">0</span>,(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) </a>
<a class="sourceLine" id="cb21-10" title="10">x1 &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u1 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))<span class="co">#obtain x1 belongs to (0,1/5)</span></a>
<a class="sourceLine" id="cb21-11" title="11">fg1 &lt;-<span class="st"> </span><span class="kw">g1</span>(x1) <span class="op">/</span><span class="st"> </span>(k<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x1) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb21-12" title="12">theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg1)</a>
<a class="sourceLine" id="cb21-13" title="13">se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg1)</a>
<a class="sourceLine" id="cb21-14" title="14"></a>
<a class="sourceLine" id="cb21-15" title="15">g2 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb21-16" title="16">  <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb21-17" title="17">}</a>
<a class="sourceLine" id="cb21-18" title="18">u2 &lt;-<span class="st"> </span><span class="kw">runif</span>(m,(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)),(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) </a>
<a class="sourceLine" id="cb21-19" title="19">x2 &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u2 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))<span class="co">#obtain x1 belongs to (1/5,2/5)</span></a>
<a class="sourceLine" id="cb21-20" title="20">fg2 &lt;-<span class="st"> </span><span class="kw">g</span>(x2) <span class="op">/</span><span class="st"> </span>(k<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x2) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb21-21" title="21">theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg2)</a>
<a class="sourceLine" id="cb21-22" title="22">se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg2)</a>
<a class="sourceLine" id="cb21-23" title="23"></a>
<a class="sourceLine" id="cb21-24" title="24">g3 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb21-25" title="25">  <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb21-26" title="26">}</a>
<a class="sourceLine" id="cb21-27" title="27">u3 &lt;-<span class="st"> </span><span class="kw">runif</span>(m,(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)),(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) </a>
<a class="sourceLine" id="cb21-28" title="28">x3 &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u3 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))<span class="co">#obtain x1 belongs to (2/5,3/5)</span></a>
<a class="sourceLine" id="cb21-29" title="29">fg3 &lt;-<span class="st"> </span><span class="kw">g</span>(x3) <span class="op">/</span><span class="st"> </span>(k<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x3) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb21-30" title="30">theta.hat[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg3)</a>
<a class="sourceLine" id="cb21-31" title="31">se[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg3)</a>
<a class="sourceLine" id="cb21-32" title="32"></a>
<a class="sourceLine" id="cb21-33" title="33">g4 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb21-34" title="34">  <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb21-35" title="35">}</a>
<a class="sourceLine" id="cb21-36" title="36">u4 &lt;-<span class="st"> </span><span class="kw">runif</span>(m,(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)),(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) </a>
<a class="sourceLine" id="cb21-37" title="37">x4 &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u4 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))<span class="co">#obtain x1 belongs to (3/5,4/5)</span></a>
<a class="sourceLine" id="cb21-38" title="38">fg4 &lt;-<span class="st"> </span><span class="kw">g</span>(x4) <span class="op">/</span><span class="st"> </span>(k<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x4) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb21-39" title="39">theta.hat[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg4)</a>
<a class="sourceLine" id="cb21-40" title="40">se[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg4)</a>
<a class="sourceLine" id="cb21-41" title="41"></a>
<a class="sourceLine" id="cb21-42" title="42">g5 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb21-43" title="43">  <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-44" title="44">}</a>
<a class="sourceLine" id="cb21-45" title="45">u5 &lt;-<span class="st"> </span><span class="kw">runif</span>(m,(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)),<span class="dv">1</span>) </a>
<a class="sourceLine" id="cb21-46" title="46">x5 &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u5 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))<span class="co">#obtain x1 belongs to (4/5,1)</span></a>
<a class="sourceLine" id="cb21-47" title="47">fg5 &lt;-<span class="st"> </span><span class="kw">g</span>(x5) <span class="op">/</span><span class="st"> </span>(k<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x5) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb21-48" title="48">theta.hat[<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg5)</a>
<a class="sourceLine" id="cb21-49" title="49">se[<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg5)</a>
<a class="sourceLine" id="cb21-50" title="50"></a>
<a class="sourceLine" id="cb21-51" title="51">theta0<span class="op">-</span><span class="kw">sum</span>(theta.hat)<span class="co">#we can get the means is almast same between two methods</span></a></code></pre></div>
<pre><code>## [1] 0.02682569</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">cat</span>(<span class="st">&quot;variance estimate of SISE=&quot;</span>,<span class="kw">sum</span>(se<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>m)</a></code></pre></div>
<pre><code>## variance estimate of SISE= 7.399279e-09</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">se0<span class="op">^</span><span class="dv">2</span><span class="op">-</span><span class="kw">sum</span>(se<span class="op">^</span><span class="dv">2</span>)<span class="co">#the variance is much smaller</span></a></code></pre></div>
<pre><code>## [1] 0.009322381</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">(se0<span class="op">^</span><span class="dv">2</span><span class="op">-</span><span class="kw">sum</span>(se<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>se0<span class="op">^</span><span class="dv">2</span><span class="co">#Reduced percentage of variance</span></a></code></pre></div>
<pre><code>## [1] 0.9921254</code></pre>
<p>In the result,we can find <span class="math inline">\(\sigma^2 - k\sum_{j=1}^k \sigma_j^2=0.00932&gt;0\)</span>,that is the variance of SISE is smaller than that of ISE. What’s more, the reduced percentage of variance is almost 99%.</p>
</div>
</div>
</div>
<div id="homework-4" class="section level1">
<h1>Homework 4</h1>
<div id="section-3" class="section level2">
<h2>6.5</h2>
<p>　Suppose a 95% symmetric <span class="math inline">\(t\)</span>-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi ^2 (2)\)</span> data with sample size <span class="math inline">\(n\)</span> = 20. Compare your <span class="math inline">\(t\)</span>-interval results with the simulation results in Example 6.4. (The <span class="math inline">\(t\)</span>-interval should be more robust to departures from normality than the interval for variance.)</p>
<div id="my-solution-3" class="section level3">
<h3>My solution</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co">#t-interval for mean</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw">set.seed</span>(<span class="dv">223</span>)</a>
<a class="sourceLine" id="cb29-3" title="3">m&lt;-<span class="fl">1e4</span>;n&lt;-<span class="dv">20</span>;ECP&lt;-<span class="kw">numeric</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb29-4" title="4">L&lt;-U&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb29-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb29-6" title="6">  x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb29-7" title="7">  y&lt;-(x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb29-8" title="8">  L[i]&lt;-<span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">qt</span>(.<span class="dv">975</span>, n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">mean</span>(y)<span class="op">/</span>(n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb29-9" title="9">  U[i]&lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">qt</span>(.<span class="dv">975</span>, n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">mean</span>(y)<span class="op">/</span>(n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb29-10" title="10">}</a>
<a class="sourceLine" id="cb29-11" title="11">c&lt;-<span class="kw">ifelse</span>(L<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;</span><span class="dv">2</span><span class="op">&lt;</span>U,<span class="dv">1</span>,<span class="dv">0</span>)<span class="co">#if the C.I. (L,U) covers the real mean,we make c equal to 1.</span></a>
<a class="sourceLine" id="cb29-12" title="12"><span class="kw">sum</span>(c)<span class="op">/</span><span class="fl">1e4</span><span class="co">#compute the CP</span></a></code></pre></div>
<pre><code>## [1] 0.9212</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co">#the interval for variance</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="co">#we can get the code from textbook</span></a>
<a class="sourceLine" id="cb31-3" title="3">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb31-4" title="4">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb31-5" title="5">UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb31-6" title="6">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb31-7" title="7">(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb31-8" title="8">} )</a>
<a class="sourceLine" id="cb31-9" title="9"><span class="kw">sum</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 799</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">mean</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.799</code></pre>
<p>Compare two empirical coverage probability</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">ECP[<span class="dv">1</span>]&lt;-<span class="kw">sum</span>(c)<span class="op">/</span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb35-2" title="2">ECP[<span class="dv">2</span>]&lt;-<span class="kw">mean</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb35-3" title="3"><span class="kw">data.frame</span>(ECP, <span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&#39;t-interval for mean&#39;</span>,<span class="st">&#39;interval for variance&#39;</span>))</a></code></pre></div>
<pre><code>##                          ECP
## t-interval for mean   0.9212
## interval for variance 0.7990</code></pre>
<p>　From the result , when the data is departed from normality,we can get the <span class="math inline">\(t\)</span>-interval for mean(92.12%) is more robust to than the interval for variance(79.9%).</p>
</div>
</div>
<div id="section-4" class="section level2">
<h2>6.6</h2>
<p>　Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt {b1}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt {b1} ≈ N(0, \frac 6n)\)</span>.</p>
<div id="my-solution-4" class="section level3">
<h3>My solution</h3>
<p>　First, we extract <span class="math inline">\(n\)</span> samples from the standard normal distribution, calculate a skewness for each sample, <span class="math display">\[
\sqrt{b_1}=\frac{\frac 1 n \sum_{i=1}^{n} (X_i-\bar{X})^3}{(\frac 1 n \sum_{i=1}^{n}(X_i-\bar{X})^2)^{3/2}}
\]</span></p>
</div>
</div>
</div>
<div id="homework-5" class="section level1">
<h1>Homework 5</h1>
<div id="section-5" class="section level2">
<h2>6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta(<span class="math inline">\(\alpha , \alpha\)</span>) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(ν)\)</span>?</p>
</div>
<div id="solution" class="section level2">
<h2>solution</h2>
<div id="against-symmetric-betaalpha-alpha-distributions" class="section level3">
<h3>against symmetric Beta(<span class="math inline">\(\alpha , \alpha\)</span>) distributions</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb37-2" title="2">  <span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb37-3" title="3">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb37-4" title="4">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb37-5" title="5">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb37-6" title="6">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb37-7" title="7">}</a>
<a class="sourceLine" id="cb37-8" title="8"></a>
<a class="sourceLine" id="cb37-9" title="9"><span class="kw">set.seed</span>(<span class="dv">013</span>)</a>
<a class="sourceLine" id="cb37-10" title="10">alpha &lt;-<span class="st"> </span><span class="fl">.1</span></a>
<a class="sourceLine" id="cb37-11" title="11">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb37-12" title="12">m &lt;-<span class="st"> </span><span class="dv">2500</span></a>
<a class="sourceLine" id="cb37-13" title="13">beta &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">14</span>, <span class="fl">.5</span>)</a>
<a class="sourceLine" id="cb37-14" title="14">N &lt;-<span class="st"> </span><span class="kw">length</span>(beta)</a>
<a class="sourceLine" id="cb37-15" title="15">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb37-16" title="16"><span class="co">#critical value for the skewness test </span></a>
<a class="sourceLine" id="cb37-17" title="17">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb37-18" title="18"></a>
<a class="sourceLine" id="cb37-19" title="19"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each beta </span></a>
<a class="sourceLine" id="cb37-20" title="20">  a &lt;-<span class="st"> </span>beta[j]</a>
<a class="sourceLine" id="cb37-21" title="21">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb37-22" title="22">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb37-23" title="23">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,a,a)</a>
<a class="sourceLine" id="cb37-24" title="24">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb37-25" title="25">  }</a>
<a class="sourceLine" id="cb37-26" title="26">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb37-27" title="27">}</a>
<a class="sourceLine" id="cb37-28" title="28"></a>
<a class="sourceLine" id="cb37-29" title="29"><span class="kw">plot</span>(beta, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb37-30" title="30">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(beta),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb37-31" title="31">     <span class="dt">main =</span> <span class="st">&#39;against  symmetric sbeta distribution&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="agains-heavy-tailed-symmetric-alternatives-such-as-tν" class="section level3">
<h3>agains heavy-tailed symmetric alternatives such as <span class="math inline">\(t(ν)\)</span></h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">set.seed</span>(<span class="dv">013</span>)</a>
<a class="sourceLine" id="cb38-2" title="2"></a>
<a class="sourceLine" id="cb38-3" title="3">df &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb38-4" title="4">N &lt;-<span class="st"> </span><span class="kw">length</span>(df)</a>
<a class="sourceLine" id="cb38-5" title="5">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb38-6" title="6"><span class="co">#critical value for the skewness test </span></a>
<a class="sourceLine" id="cb38-7" title="7">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb38-8" title="8"></a>
<a class="sourceLine" id="cb38-9" title="9"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each df </span></a>
<a class="sourceLine" id="cb38-10" title="10">  a &lt;-<span class="st"> </span>df[j]</a>
<a class="sourceLine" id="cb38-11" title="11">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb38-12" title="12">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb38-13" title="13">    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,a)</a>
<a class="sourceLine" id="cb38-14" title="14">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb38-15" title="15">  }</a>
<a class="sourceLine" id="cb38-16" title="16">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb38-17" title="17">}</a>
<a class="sourceLine" id="cb38-18" title="18"></a>
<a class="sourceLine" id="cb38-19" title="19"><span class="kw">plot</span>(df, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb38-20" title="20">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(df),</a>
<a class="sourceLine" id="cb38-21" title="21">     <span class="dt">main =</span> <span class="st">&#39;against  heavy-tailed symmetric t distribution&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From two plots, we can obviously find that the power(less than 0.1) of the skewness test of normality against symmetric Beta(<span class="math inline">\(\alpha , \alpha\)</span>) distributions is very small. On the contrary, the results is very different for heavy-tailed symmetric ditribution <span class="math inline">\(t(ν)\)</span>,whose power can reach to 0.8 and is much larger than that of beta distribution.</p>
</div>
</div>
<div id="a" class="section level2">
<h2>6.A</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level<span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_0 : \mu = \mu_0\)</span> vs <span class="math inline">\(H_1 : \mu \neq \mu_0\)</span>, where <span class="math inline">\(\mu _0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="solution-1" class="section level2">
<h2>solution</h2>
<p>We take <span class="math inline">\(t(3)\)</span> for example,which is non-normal and mild departures from normality. $ H_0 : = 0$ vs <span class="math inline">\(H_1 : \mu \neq 0\)</span>,</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span>;<span class="kw">set.seed</span>(<span class="dv">013</span>)</a>
<a class="sourceLine" id="cb39-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb39-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb39-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb39-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb39-7" title="7">x &lt;-<span class="st"> </span><span class="kw">rt</span>(n, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb39-8" title="8">ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb39-9" title="9">p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb39-10" title="10">}</a>
<a class="sourceLine" id="cb39-11" title="11">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb39-12" title="12">se.hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.hat) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb39-13" title="13"><span class="kw">print</span>(<span class="kw">c</span>(p.hat, se.hat))</a></code></pre></div>
<pre><code>## [1] 0.042800000 0.002024059</code></pre>
<p>We can find the empirical ty1 error is similar to nominal ty1 error (0.05).So we can conclude that the t-test is robust to mild departures from normality</p>
<div id="a.1" class="section level3">
<h3>6.A.1</h3>
<p>when the sampled population is <span class="math inline">\(\chi^2(1)\)</span>, whose mean equals 1</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span>;<span class="kw">set.seed</span>(<span class="dv">013</span>)</a>
<a class="sourceLine" id="cb41-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb41-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb41-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a>
<a class="sourceLine" id="cb41-6" title="6"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb41-7" title="7">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb41-8" title="8">ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb41-9" title="9">p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb41-10" title="10">}</a>
<a class="sourceLine" id="cb41-11" title="11">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb41-12" title="12"><span class="kw">print</span>(p.hat)</a></code></pre></div>
<pre><code>## [1] 0.1048</code></pre>
<p>We can find We can find the empirical ty1 error (0.1048) is far away from nominal ty1 error (0.05) when the sampled population is <span class="math inline">\(\chi^2(1)\)</span>.</p>
</div>
<div id="a.2" class="section level3">
<h3>6.A.2</h3>
<p>when the sampled population is uniform(0,2), whose mean equals 1</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span>;<span class="kw">set.seed</span>(<span class="dv">013</span>)</a>
<a class="sourceLine" id="cb43-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb43-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb43-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb43-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a>
<a class="sourceLine" id="cb43-6" title="6"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb43-7" title="7">x &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">0</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-8" title="8">ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb43-9" title="9">p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb43-10" title="10">}</a>
<a class="sourceLine" id="cb43-11" title="11">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb43-12" title="12"><span class="kw">print</span>(p.hat)</a></code></pre></div>
<pre><code>## [1] 0.0499</code></pre>
<p>We can find the empirical ty1 error (0.0499) is similar to nominal ty1 error (0.05) when the sampled population is uniform(0,2).</p>
</div>
<div id="a.3" class="section level3">
<h3>6.A.3</h3>
<p>when the sampled population is <span class="math inline">\(exp(1)\)</span>, whose mean equals 1</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span>;<span class="kw">set.seed</span>(<span class="dv">013</span>)</a>
<a class="sourceLine" id="cb45-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb45-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb45-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb45-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a>
<a class="sourceLine" id="cb45-6" title="6"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb45-7" title="7">x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb45-8" title="8">ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb45-9" title="9">p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb45-10" title="10">}</a>
<a class="sourceLine" id="cb45-11" title="11">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb45-12" title="12"><span class="kw">print</span>(p.hat)</a></code></pre></div>
<pre><code>## [1] 0.0773</code></pre>
<p>We can find the empirical ty1 error (0.0773) is far away from nominal ty1 error (0.05) when the sampled population is <span class="math inline">\(exp(1)\)</span></p>
<p>In conlusion,the empirical Type I error rate of the t-test isn’t approximately equal to the nominal significance level<span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. And the t-test is robust to mild departures from normality from the example one.</p>
</div>
</div>
<div id="discussion" class="section level2">
<h2>6.discussion</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level? * What is the corresponding hypothesis test problem? * What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? * What information is needed to test your hypothesis?</p>
</div>
<div id="solution-2" class="section level2">
<h2>solution</h2>
<p>*the null hypothesis <span class="math inline">\(H_0\)</span>:the rate one = the rate two;<span class="math inline">\(H_\alpha\)</span>:the rate one<span class="math inline">\(\neq\)</span>the rate two</p>
<p>*two method can be saw as two binomial distribution of p equals 0.05. We can use Z-test of large sample.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">n&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb47-2" title="2">alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb47-3" title="3">xbar&lt;-<span class="fl">0.651</span>;ybar&lt;-<span class="fl">0.676</span></a>
<a class="sourceLine" id="cb47-4" title="4">pbar&lt;-(xbar<span class="op">+</span>ybar)<span class="op">/</span><span class="dv">2</span> <span class="co">#the approximate probability</span></a>
<a class="sourceLine" id="cb47-5" title="5">u&lt;-(ybar<span class="op">-</span>xbar)<span class="op">/</span><span class="kw">sqrt</span>((<span class="dv">2</span><span class="op">*</span>pbar<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pbar))<span class="op">/</span>n)<span class="co">#Z-test value</span></a>
<a class="sourceLine" id="cb47-6" title="6">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>)<span class="co">#the critical value</span></a>
<a class="sourceLine" id="cb47-7" title="7"><span class="kw">print</span>(<span class="kw">as.integer</span>(<span class="kw">abs</span>(u) <span class="op">&gt;=</span><span class="st"> </span>cv))</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co">#the answer equals 1 means we reject the H0</span></a></code></pre></div>
<p>From the result, we reject the null hypothesis, so we can’t say the powers are equal at 0.05 level. They are different in large probility.</p>
</div>
</div>
<div id="homework-6" class="section level1">
<h1>Homework 6</h1>
<div id="section-6" class="section level2">
<h2>7.6</h2>
<p>Efron and Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in five subjects [84, Table 7.1], [188, Table 1.2.1]. The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores (xi1, . . . , xi5) for the ith student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: <span class="math inline">\(\hat{\rho}_{12}=\hat{\rho}\)</span>(mec,vec),<span class="math inline">\(\hat{\rho}_{34}=\hat{\rho}\)</span>(alg,ana), <span class="math inline">\(\hat{\rho}_{35}=\hat{\rho}\)</span>(alg, sta), <span class="math inline">\(\hat{\rho}_{45}=\hat{\rho}\)</span>(ana, sta).</p>
</div>
<div id="solution-3" class="section level2">
<h2>solution</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">library</span>(<span class="st">&quot;bootstrap&quot;</span>)</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">data</span>(scor, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</a>
<a class="sourceLine" id="cb50-3" title="3"><span class="kw">pairs</span>(scor,<span class="dt">pch =</span> <span class="dv">21</span>)<span class="co">#the scatter plots</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="kw">cor</span>(scor)<span class="co">#the sample correlation matrix</span></a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<p>From the the plot and the sample correlation matrix, we can find the more large the cor,the stronger linear relationship of the plot.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co">#bootstrap estimates of the standard errors for each of the cor</span></a>
<a class="sourceLine" id="cb53-2" title="2"><span class="co">#I don&#39;t know how to use loops to represent, so I wrote four functions.</span></a>
<a class="sourceLine" id="cb53-3" title="3"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb53-4" title="4"><span class="kw">set.seed</span>(<span class="dv">287</span>)</a>
<a class="sourceLine" id="cb53-5" title="5"><span class="co">#cor12 </span></a>
<a class="sourceLine" id="cb53-6" title="6">b.cor12 &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){<span class="kw">cor</span>(scor[i,<span class="dv">1</span>],scor[i,<span class="dv">2</span>])} </a>
<a class="sourceLine" id="cb53-7" title="7">obj&lt;-<span class="kw">boot</span>(scor,b.cor12,<span class="dt">R=</span><span class="dv">999</span>)</a>
<a class="sourceLine" id="cb53-8" title="8">se12&lt;-<span class="kw">sd</span>(obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb53-9" title="9"><span class="co">#cor34</span></a>
<a class="sourceLine" id="cb53-10" title="10">b.cor34 &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){<span class="kw">cor</span>(scor[i,<span class="dv">3</span>],scor[i,<span class="dv">4</span>])} </a>
<a class="sourceLine" id="cb53-11" title="11">obj&lt;-<span class="kw">boot</span>(scor,b.cor34,<span class="dt">R=</span><span class="dv">999</span>)</a>
<a class="sourceLine" id="cb53-12" title="12">se34&lt;-<span class="kw">sd</span>(obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb53-13" title="13"><span class="co">#cor35</span></a>
<a class="sourceLine" id="cb53-14" title="14">b.cor35 &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){<span class="kw">cor</span>(scor[i,<span class="dv">3</span>],scor[i,<span class="dv">5</span>])} </a>
<a class="sourceLine" id="cb53-15" title="15">obj&lt;-<span class="kw">boot</span>(scor,b.cor35,<span class="dt">R=</span><span class="dv">999</span>)</a>
<a class="sourceLine" id="cb53-16" title="16">se35&lt;-<span class="kw">sd</span>(obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb53-17" title="17"><span class="co">#cor45</span></a>
<a class="sourceLine" id="cb53-18" title="18">b.cor45 &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){<span class="kw">cor</span>(scor[i,<span class="dv">4</span>],scor[i,<span class="dv">5</span>])} </a>
<a class="sourceLine" id="cb53-19" title="19">obj&lt;-<span class="kw">boot</span>(scor,b.cor45,<span class="dt">R=</span><span class="dv">999</span>)</a>
<a class="sourceLine" id="cb53-20" title="20">se45&lt;-<span class="kw">sd</span>(obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb53-21" title="21"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">SE12.boot=</span>se12,<span class="dt">SE34.boot=</span>se34,<span class="dt">SE35.boot=</span>se35,<span class="dt">SE45.boot=</span>se45),<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## SE12.boot SE34.boot SE35.boot SE45.boot 
##    0.0801    0.0462    0.0602    0.0682</code></pre>
<p>From the result,we can get the bootstrap estimates of the standard errors for <span class="math inline">\(\hat{\rho}_{12}\)</span> is 0.0801, for <span class="math inline">\(\hat{\rho}_{34}\)</span> is 0.0462, for <span class="math inline">\(\hat{\rho}_{35}\)</span> is 0.0602,for <span class="math inline">\(\hat{\rho}_{45}\)</span> is 0.0682.</p>
</div>
<div id="b" class="section level2">
<h2>7.B</h2>
<p>(7.A Conduct a Monte Carlo study to estimate the coverage probabilities of the standard normal bootstrap confidence interval, the basic bootstrap confidence interval, and the percentile confidence interval. Sample from a normal population and check the empirical coverage rates for the sample mean. Find the proportion of times that the confidence intervals miss on the left, and the porportion of times that the confidence intervals miss on the right.)</p>
<p>7.B Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2(5)\)</span> distributions (positive skewness)</p>
</div>
<div id="solution-4" class="section level2">
<h2>solution</h2>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">set.seed</span>(<span class="dv">014</span>)</a>
<a class="sourceLine" id="cb55-2" title="2">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb55-3" title="3">  <span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb55-4" title="4">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb55-5" title="5">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb55-6" title="6">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb55-7" title="7">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb55-8" title="8">}</a>
<a class="sourceLine" id="cb55-9" title="9"></a>
<a class="sourceLine" id="cb55-10" title="10"><span class="co">#for normal population</span></a>
<a class="sourceLine" id="cb55-11" title="11">theta&lt;-<span class="dv">0</span>;b&lt;-<span class="dv">1</span>;n&lt;-<span class="fl">2e1</span>;m&lt;-<span class="fl">1e3</span>;<span class="kw">library</span>(boot);<span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb55-12" title="12">boot.sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">sk</span>(x[i])</a>
<a class="sourceLine" id="cb55-13" title="13">ci.norm&lt;-ci.basic&lt;-ci.perc&lt;-ci.bca&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb55-14" title="14"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb55-15" title="15">  x &lt;-<span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb55-16" title="16">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>x,<span class="dt">statistic=</span>boot.sk, <span class="dt">R =</span> <span class="dv">999</span>)</a>
<a class="sourceLine" id="cb55-17" title="17">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb55-18" title="18">  ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb55-19" title="19">  ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb55-20" title="20">  ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb55-21" title="21">}</a>
<a class="sourceLine" id="cb55-22" title="22">CP1&lt;-<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>theta <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>theta)</a>
<a class="sourceLine" id="cb55-23" title="23">L1&lt;-<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;=</span>theta);R1&lt;-<span class="kw">mean</span>( ci.norm[,<span class="dv">2</span>]<span class="op">&lt;=</span>theta)</a>
<a class="sourceLine" id="cb55-24" title="24">CP2&lt;-<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>theta <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>theta)</a>
<a class="sourceLine" id="cb55-25" title="25">L2&lt;-<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;=</span>theta);R2&lt;-<span class="kw">mean</span>( ci.basic[,<span class="dv">2</span>]<span class="op">&lt;=</span>theta)</a>
<a class="sourceLine" id="cb55-26" title="26">CP3&lt;-<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>theta <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>theta)</a>
<a class="sourceLine" id="cb55-27" title="27">L3&lt;-<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;=</span>theta);R3&lt;-<span class="kw">mean</span>( ci.perc[,<span class="dv">2</span>]<span class="op">&lt;=</span>theta)</a>
<a class="sourceLine" id="cb55-28" title="28">CP&lt;-<span class="kw">c</span>(CP1,CP2,CP3);L&lt;-<span class="kw">c</span>(L1,L2,L3);R&lt;-<span class="kw">c</span>(R1,R2,R3)                                     </a>
<a class="sourceLine" id="cb55-29" title="29"><span class="kw">data.frame</span>(<span class="st">&quot;CP&quot;</span>=CP,<span class="st">&quot;Miss on the left&quot;</span>=L,<span class="st">&quot;Miss on the right&quot;</span> =R,</a>
<a class="sourceLine" id="cb55-30" title="30">           <span class="dt">row.names =</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a></code></pre></div>
<pre><code>##          CP Miss.on.the.left Miss.on.the.right
## norm  0.892            0.052             0.056
## basic 0.884            0.052             0.064
## perc  0.973            0.014             0.013</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co">#for $\chi^2(5)$ </span></a>
<a class="sourceLine" id="cb57-2" title="2"><span class="kw">set.seed</span>(<span class="dv">013</span>)</a>
<a class="sourceLine" id="cb57-3" title="3">theta&lt;-<span class="dv">4</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">10</span>)<span class="co">#the real sk of \chisq(5)</span></a>
<a class="sourceLine" id="cb57-4" title="4">b&lt;-<span class="dv">1</span>;n&lt;-<span class="dv">20</span>;m&lt;-<span class="fl">1e3</span>;<span class="kw">library</span>(boot);<span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb57-5" title="5">boot.sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">sk</span>(x[i])</a>
<a class="sourceLine" id="cb57-6" title="6">ci.norm&lt;-ci.basic&lt;-ci.perc&lt;-ci.bca&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb57-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb57-8" title="8">  x &lt;-<span class="kw">rchisq</span>(n,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb57-9" title="9">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>x,<span class="dt">statistic=</span>boot.sk, <span class="dt">R =</span> <span class="dv">999</span>)</a>
<a class="sourceLine" id="cb57-10" title="10">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb57-11" title="11">  ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb57-12" title="12">  ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb57-13" title="13">  ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb57-14" title="14">}</a>
<a class="sourceLine" id="cb57-15" title="15">CP1&lt;-<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>theta <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>theta)</a>
<a class="sourceLine" id="cb57-16" title="16">L1&lt;-<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;=</span>theta);R1&lt;-<span class="kw">mean</span>( ci.norm[,<span class="dv">2</span>]<span class="op">&lt;=</span>theta)</a>
<a class="sourceLine" id="cb57-17" title="17">CP2&lt;-<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>theta <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>theta)</a>
<a class="sourceLine" id="cb57-18" title="18">L1&lt;-<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;=</span>theta);R1&lt;-<span class="kw">mean</span>( ci.basic[,<span class="dv">2</span>]<span class="op">&lt;=</span>theta)</a>
<a class="sourceLine" id="cb57-19" title="19">CP3&lt;-<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>theta <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>theta)</a>
<a class="sourceLine" id="cb57-20" title="20">L1&lt;-<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;=</span>theta);R1&lt;-<span class="kw">mean</span>( ci.perc[,<span class="dv">2</span>]<span class="op">&lt;=</span>theta)</a>
<a class="sourceLine" id="cb57-21" title="21">CP&lt;-<span class="kw">c</span>(CP1,CP2,CP3);L&lt;-<span class="kw">c</span>(L1,L2,L3);R&lt;-<span class="kw">c</span>(R1,R2,R3)                                     </a>
<a class="sourceLine" id="cb57-22" title="22"><span class="kw">data.frame</span>(<span class="st">&quot;CP&quot;</span>=CP,<span class="st">&quot;Miss on the left&quot;</span>=L,<span class="st">&quot;Miss on the right&quot;</span> =R,</a>
<a class="sourceLine" id="cb57-23" title="23">           <span class="dt">row.names =</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a></code></pre></div>
<pre><code>##          CP Miss.on.the.left Miss.on.the.right
## norm  0.742            0.000             0.275
## basic 0.722            0.052             0.064
## perc  0.725            0.014             0.013</code></pre>
<p>The first line is the cp of normal,basic and percentile.The second lines reprents the proportion of times that the confidence intervals miss on the left. And the third line isthe proportion of times that the confidence intervals miss on the right.</p>
<p>We can obviously find the CP of the sample skewness statistic for normal populations is better than that for <span class="math inline">\(\chi^2(5)\)</span> distributions.</p>
</div>
</div>
<div id="homework-7" class="section level1">
<h1>Homework 7</h1>
<div id="exercise-11.4" class="section level2">
<h2>Exercise 11.4</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}})\]</span> and <span class="math display">\[S_{k}(a)=P(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}})\]</span> for <span class="math inline">\(k =4: 25, 100, 500, 1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(k\)</span> degrees of freedom.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>Firstly, we define a function S with parameters <span class="math inline">\(k\)</span> and <span class="math inline">\(a\)</span> to generate the curve <span class="math inline">\(S_k(a)-S_{k-1}(a)\)</span>. If we can compute the intersection points of the curves <span class="math inline">\(S_k(a)\)</span> and <span class="math inline">\(S_{k-1}(a)\)</span> by computing the root of function <span class="math inline">\(S_k(a)-S_{k-1}(a)\)</span>.</p>
<p>I use bisection method to solve this problem.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb59-2" title="2">eps &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span><span class="co">#criterion to judge whether function is near to 0</span></a>
<a class="sourceLine" id="cb59-3" title="3">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)<span class="co">#k mentioned in the question</span></a>
<a class="sourceLine" id="cb59-4" title="4"></a>
<a class="sourceLine" id="cb59-5" title="5">S &lt;-<span class="st"> </span><span class="cf">function</span>(k,a){</a>
<a class="sourceLine" id="cb59-6" title="6">  <span class="kw">return</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df =</span> k))<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k<span class="dv">-1</span>)))</a>
<a class="sourceLine" id="cb59-7" title="7">}<span class="co">#S_k(a)-S_{k-1}(a)</span></a>
<a class="sourceLine" id="cb59-8" title="8"></a>
<a class="sourceLine" id="cb59-9" title="9"></a>
<a class="sourceLine" id="cb59-10" title="10">Root &lt;-<span class="st"> </span><span class="cf">function</span>(k1){</a>
<a class="sourceLine" id="cb59-11" title="11">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.1</span>, <span class="kw">sqrt</span>(k1)<span class="op">-</span><span class="fl">0.1</span>,<span class="dt">length =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb59-12" title="12">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">S</span>(k1,a[<span class="dv">1</span>]), <span class="kw">S</span>(k1,a[<span class="dv">2</span>]), <span class="kw">S</span>(k1,a[<span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb59-13" title="13"><span class="cf">while</span>(<span class="kw">abs</span>(y[<span class="dv">2</span>]) <span class="op">&gt;</span><span class="st"> </span>eps) {</a>
<a class="sourceLine" id="cb59-14" title="14">  <span class="cf">if</span> (y[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>y[<span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb59-15" title="15">    a[<span class="dv">3</span>] &lt;-<span class="st"> </span>a[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb59-16" title="16">    y[<span class="dv">3</span>] &lt;-<span class="st"> </span>y[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb59-17" title="17">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb59-18" title="18">    a[<span class="dv">1</span>] &lt;-<span class="st"> </span>a[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb59-19" title="19">    y[<span class="dv">1</span>] &lt;-<span class="st"> </span>y[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb59-20" title="20">  }</a>
<a class="sourceLine" id="cb59-21" title="21">  a[<span class="dv">2</span>] &lt;-<span class="st"> </span>(a[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>a[<span class="dv">3</span>]) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb59-22" title="22">  y[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">S</span>(k1,a[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb59-23" title="23">}</a>
<a class="sourceLine" id="cb59-24" title="24">result &lt;-<span class="kw">list</span>(k1,a[<span class="dv">2</span>],y[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb59-25" title="25"><span class="kw">return</span>(result)</a>
<a class="sourceLine" id="cb59-26" title="26">}</a>
<a class="sourceLine" id="cb59-27" title="27"></a>
<a class="sourceLine" id="cb59-28" title="28"><span class="cf">for</span>(i <span class="cf">in</span> k){<span class="co">#print the output of each k</span></a>
<a class="sourceLine" id="cb59-29" title="29">  <span class="kw">cat</span>(<span class="st">&#39;k:&#39;</span>,<span class="kw">Root</span>(i)[[<span class="dv">1</span>]],<span class="st">&#39;root:&#39;</span>,<span class="kw">Root</span>(i)[[<span class="dv">2</span>]],<span class="st">&#39;value of function:&#39;</span>,<span class="kw">Root</span>(i)[[<span class="dv">3</span>]],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb59-30" title="30">  </a>
<a class="sourceLine" id="cb59-31" title="31">} </a></code></pre></div>
<pre><code>## k: 4 root: 1.492188 value of function: 2.19293e-06 
## k: 5 root: 1.53161 value of function: -2.600727e-05 
## k: 6 root: 1.576228 value of function: 0.000107711 
## k: 7 root: 1.59038 value of function: 3.14324e-05 
## k: 8 root: 1.57849 value of function: -8.553791e-05 
## k: 9 root: 1.5875 value of function: -7.580885e-05 
## k: 10 root: 1.581139 value of function: -9.644197e-05 
## k: 11 root: 1.658312 value of function: 3.993887e-05 
## k: 12 root: 1.732051 value of function: 0.0001166009 
## k: 13 root: 1.589929 value of function: -6.878761e-05 
## k: 14 root: 1.649475 value of function: -4.503052e-06 
## k: 15 root: 1.70693 value of function: 3.769164e-05 
## k: 16 root: 1.525 value of function: -0.000104609 
## k: 17 root: 1.571165 value of function: -6.213979e-05 
## k: 18 root: 1.61599 value of function: -3.041938e-05 
## k: 19 root: 1.659587 value of function: -6.8282e-06 
## k: 20 root: 2.236068 value of function: 0.0001210204 
## k: 21 root: 2.291288 value of function: 0.0001079948 
## k: 22 root: 2.345208 value of function: 9.578466e-05 
## k: 23 root: 2.397916 value of function: 8.454769e-05 
## k: 24 root: 2.44949 value of function: 7.434282e-05 
## k: 25 root: 2.5 value of function: 6.516662e-05 
## k: 100 root: 5 value of function: 1.068744e-09 
## k: 500 root: 11.18034 value of function: 0 
## k: 1000 root: 15.81139 value of function: 0</code></pre>
<p>Next, I plot two curves to show in two cases, the intersection points computed by the algorithm is the very zero point of the difference of two functions.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">k &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb61-2" title="2">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb61-3" title="3">y0 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(a))</a>
<a class="sourceLine" id="cb61-4" title="4">y &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df =</span> k))<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb61-5" title="5"><span class="kw">plot</span>(a,y,<span class="st">&#39;l&#39;</span>)</a>
<a class="sourceLine" id="cb61-6" title="6"><span class="kw">lines</span>(a,y0)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAS1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmtv+QOgCQ2/+2ZgC225C2///bkDrb////tmb/25D//7b//9v///++esKWAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGjklEQVR4nO2cbZ+iNhRH0+1u27XjTmsd9ft/0g4w4hPknxvyhJ7zYn+OTW4upyEhCHEn8OJqJ9A6CBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSGATdNy6nm//ZkqnPUyCdu7n8GF//vD8WAQdt6OW3e//ZUimRSyCDpu388f9y5xk9CCBcQz66kKMQTMcNsMs9jL9h+sgCYIECBIgSGC7DnIjXAdNcdy+jJcR62L1e6Y8msU4Bu3dmy70VDBICxAkQJAg8R1FtxqyCJq9o2hvtzZZBAXcD3ptQQF3FF9b0HP0IHf1b3DxQPQdxeYFnUfJPIL0HcXWBbmHD8E1EifQJm7iU3CVxBm0iJv8GFzHwm6Ns5ib+RxcKXEOreFm/wiulTiJtnCev4KrJc6iJZz3z+B6Ar1YNYUryH1ihRerceFKUkTQipcaD3mxWL2ljKD19qDHtFisXjORFYvVa8oJKh0uDVNJIejCZE4IGplOCUEjCPIzkxGCziBIgCA/cwkhaGA2n8KCmv1tvhVBucItZT4dBHV4skFQB4L8+JJBkMgFQQhS+FNBEIIUCPIjMnl5QSoRBC387/aCVcJFI/N4cUE6DQQtLmEtWCVcJAFZvLSgkCQQlKCMrWCVcHEgyE9QDghKUchUsEq4fCm8rqDADOyCDhuXYFeF6oJCE4jpQTvnFu+89dSCTgkc1RaUfmi5L7jzvWiQsN08hDcfJ2j/aeftdNya93C7+20+33YAKYgV1D3iO5hZsItk3R5kaD1mFvvtly2dRe1mIaugNCCobLh8jb+iIFPbWQQdNt01UjfVtfjGoa3pfIL6F6Gu3hyLD5eYRgR9qWnvfTFjy9kEffzoBfnfOKygydpk5R5U3lAjgror9e+n83DtCVfakLm9XNP8p6PPC+75Dcndw4ci2Furfx1U1NAaBZ0KPnUf0VImQbatKYoZakaQcWuKUoJi2skiyLyxQBlDUa1kmuatW1OUMBTXRhs9qIShyBZyjUHmrSmyG2pKUMzWFJkNxYZv4Dpo/CqroicQlLUPRcdu4kIxrg0L8ZGbuFCMa8TAgritTPMRrYSzJGrhC8W733UnmsmgaFHIxnqQsaEglgVs5kIxrqEAFsZr50IxsiVJm4IWhUs6Di2N1aKglI0tjpRbUOSG26k60fIwbfagVO0lCPLUgorGKD63LD/LynbCEovVRU2mrm6NUmSxel+oyCIqUZhiS43bYvnv46SKk/dXjSTNXldLNmQ23oMiDzXhjNLeYvWxqPlwqyxVyi1WJwpnLC2jJS+YI5zlmGslGtHu1VC0OFyoouR3JNciqL9bG1DGHFaGTF7wQlpBulKWXx5XJejkvdtf+ReRJgT1NSdM5LJzWsssdl958t3APKxSUEkQJECQAEGCaoJWQyVBwVjarbdiyxIxfbsISlcWQQnD1oqYvl0EpSuLoIRha0VM3y6C0pV9HkGrAUECBAkQJECQAEECBAkQJECQAEECBAkQJECQoLCgvXPjlrGXHb/m+PhzfJb2uqK/qA5roqygfbe/1/lAP/4Qu+seNuPDxjcV/UVlWBtFBQ0Pzrx//d9VuzLvL6883Fb0Fl2y2fMURQUNmzCe3zXb+U+Dvfs5HuttRW9RFdZKWUF97z8fy/tfTuygfxF0U9FbNCCsiaKChlHkayw5bLqnrd99hzIe9U1Ff9GAsCbqCfr6yjdixAgKCGui4ik2fPVjZl/h0ynyFNNhTVQcpIevfJNy6CB9ehSUbK6vN80PBx12iqlp/sHlSk+x2+u9/njDBml5oXg9i8mwJgovNXbDiuG47Y/COecdKvqjHsruxFLjqqgMa4LFqgBBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBguYFpX2YxU7rgrrHoXbeJ4My07igw9+/Uj6RGUHjgjr2Vc+x1gXtnPv2Dz1olv7s4hSbp382c88pNkvXeQ6bhO+mmGlc0PD473vFeb51QdVBkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJ/gd2U9o4yaDwRwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;The root of curves when k = &#39;</span>,k,<span class="st">&#39;is&#39;</span>,<span class="kw">Root</span>(k)[[<span class="dv">2</span>]],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a></code></pre></div>
<pre><code>## The root of curves when k =  4 is 1.492188</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">k &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb64-2" title="2">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb64-3" title="3">y0 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(a))</a>
<a class="sourceLine" id="cb64-4" title="4">y &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df =</span> k))<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb64-5" title="5"><span class="kw">plot</span>(a,y,<span class="st">&#39;l&#39;</span>)</a>
<a class="sourceLine" id="cb64-6" title="6"><span class="kw">lines</span>(a,y0)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;The root of curves when k = &#39;</span>,k,<span class="st">&#39;is&#39;</span>,<span class="kw">Root</span>(k)[[<span class="dv">2</span>]],<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a></code></pre></div>
<pre><code>## The root of curves when k =  10 is 1.581139</code></pre>
<p>As the figures present, the intersection of the function value and zero is the numble computed exactly.</p>
</div>
</div>
<div id="homework-8" class="section level1">
<h1>Homework 8</h1>
<div id="section-7" class="section level2">
<h2>7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="solution-of-7.8" class="section level2">
<h2>solution of 7.8</h2>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">data</span>(scor, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</a>
<a class="sourceLine" id="cb67-2" title="2">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb67-3" title="3"><span class="co">#jackknife</span></a>
<a class="sourceLine" id="cb67-4" title="4">cov1&lt;-<span class="kw">cov</span>(scor)</a>
<a class="sourceLine" id="cb67-5" title="5">ev1&lt;-<span class="kw">eigen</span>(cov1)</a>
<a class="sourceLine" id="cb67-6" title="6">lambda1&lt;-<span class="kw">sort</span>(ev1<span class="op">$</span>values)[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb67-7" title="7">theta.hat&lt;-lambda1<span class="op">/</span><span class="kw">sum</span>(ev1<span class="op">$</span>values)</a>
<a class="sourceLine" id="cb67-8" title="8">theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb67-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb67-10" title="10">  cov2&lt;-<span class="kw">cov</span>(scor[<span class="op">-</span>i,])</a>
<a class="sourceLine" id="cb67-11" title="11">  ev2&lt;-<span class="kw">eigen</span>(cov2)</a>
<a class="sourceLine" id="cb67-12" title="12">  lambda2&lt;-<span class="kw">sort</span>(ev2<span class="op">$</span>values)[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb67-13" title="13">  theta.jack[i]&lt;-lambda2<span class="op">/</span><span class="kw">sum</span>(ev2<span class="op">$</span>values)</a>
<a class="sourceLine" id="cb67-14" title="14">}</a>
<a class="sourceLine" id="cb67-15" title="15">bias_jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat)</a>
<a class="sourceLine" id="cb67-16" title="16">se_jack&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb67-17" title="17"><span class="kw">data.frame</span>(<span class="st">&quot;bias_jack&quot;</span>=bias_jack,<span class="st">&quot;se_jack&quot;</span>=se_jack)</a></code></pre></div>
<pre><code>##     bias_jack    se_jack
## 1 0.001069139 0.04955231</code></pre>
<p>From the results, we can get the jackknife estimates of bias equals 0.00106913 andthe jackknife estimates of standard error equals 0.04955231.</p>
</div>
<div id="section-8" class="section level2">
<h2>7.10</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
</div>
<div id="solution-of-7.10" class="section level2">
<h2>solution of 7.10</h2>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>) <span class="co">#sequence for plotting fits</span></a>
<a class="sourceLine" id="cb73-2" title="2">L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb73-3" title="3"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb73-4" title="4">yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</a>
<a class="sourceLine" id="cb73-5" title="5"><span class="kw">lines</span>(a, yhat1, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb74-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb74-3" title="3">yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb74-4" title="4"><span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAt1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZjpmkGZmkJBmkLZmkNtmtrZmtttmtv+QOgCQZjqQkLaQtpCQttuQ2/+2ZgC2Zjq2ZpC2kDq2kGa225C227a229u22/+2/9u2///bkDrbtmbbtpDb27bb29vb2//b////tmb/25D/27b//7b//9v///+HKtyXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAL5klEQVR4nO2dDZfjphWGmcls7TZf7TjbJG2zk3RX269sR9mkI6/t//+7KkBgJAEvIJBk+77n7I5sXV+Jx3AB6RqxE8krtvQJrF0ECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQJaDNDx458ZY1/88IJNK3b/bPfxj+fT8Ym9CvCRrKUAHV4zqYcP0NYF6NPr+6sF1BZLyVE7DLkAOWtWTi0EqGbsjreuj1vGHlVRDzu+ffrIK9eX77jZ8f2WPbwVe2t29/fX7P7DeXcl8P63q0G/fM7YZz/kP9NlALUV6E4Q4FDa8pmAGlmx+H5dzwQgrlcv5909QJV8+zH7qS4DqEWx6TYrWVYNqIXyu5fTftux2rwc3ytArz6cfjN3i0/JGNRa/unl065Am1sGkCygUD0AxPXrv9r2sjFangT0pvtIb7cEJC3rr3/OfqrrA3T8UbaWDS+7qGcqBsmwpHcbgAp2ZYs2sfqPvGhtKSUggY3HnYeffuUGqiGagIzdfUAb/xGTtWSQbgHcfcvOLUQAkpVLsFH1wgRk7L7mGiS7+Xak1/U8svQN325ErDGisI5BAtBotxmDmi/fZj/ThQC1hVbiX33N0Xx6YrIGvXrhmxvVi1WsX4P0bvGW7sVEc9WBPJuWmmp8UlMNdvcX0W2rcYwe+/CgUpnjIB2D1O5mPA7KH4mWnqx+J4fS+5bX1//RvdjD21q0meM/t+3weNSLdbv5COnhZ3Mk/df857n45Y7j+69KzjUna3FAaxcBAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAooDpFIHZki/XYuiANUqca4pkE66UsUAOj5pLHXR7PY1KQbQYafTk5qbaWSZaxC7GJUA1Magrgo5Y9D6O8WOTRlAOrXQGYFWD0jVnkKA5naXXbp9zQwovmkvpHkA7bfOZNvbBmQkN7vG0msHVDgGdZ3XBdeg8r0Y778uGlCnYjGountHgLxqJ6wEyKv99jMC5NXxyf2bmksBVGguNru7YiJAfpWazc/uDh8vZXJT7nLH7O7g4ZKmfwtMVku5Q0dLmiAvMZsv5Q4dLQXQLV0PSgFUdi42tzt4uFg+2v5GAEX3YtqcrihaxZYCVMpdZhlfIAGyyKzgKYAqscTDtJvuq4hBjpbeezsBUCVudh12k1Z3WEMv5oiF/TfjAakb79Puuq9gHGTvLYZvxQNSN97rawU0eB18DL0lb7zvt5OC0EKAeuHXAsiCMfgY502xRk23el+qlolBfSJWPqNPBh8i6oRgCt4ivdiwzuD6UwoQTsFbZBwEBvH2Pi3YecSJhCRQRbjLJj8g+55IQIfdo77x7u7FAlLwlhlJx/O5rRrkm9S79iQMFL+R/ZdvoHhhKXi+lpcOyDtQvKgUPH/kDvYi/6j1+NjEFYdXBAiE7mA3akPVoCkns6oLZrkBhavxjLevGpBYHLzytrC2JT7uv3oxO/zE4xYXGj0G+9Fbzd27tvNuR0RuY37JqBK1Z2Xd/Ficja/Fp13u4MX29GKi3ux/LxblXclAsc9Av/JOzeSbwUdQG7z0HJBnHCRr1/F/p9XUIMc0HkzuxbvBh1AbqgZVnh866drlbIhLXjDTr3pAHLEoOQbV3hWZa9l9NU6jNQAaNbtclzvEMPmiLphZAQ1oZASUQ8vHoBGMXDEojxbvxWwsMl0wy/KL5kXHQTFznQRAVY6foS4JKGo2mDIOyvFL7wUBxU2X0waK0zUbIHss7gPKPdXI8ciFuQDZevPhm9knqzke2jEToGFlYZqPkQHkbXEpTYyl92L2MVo5jVlY38wKKI+WAKS2CJB5nB6f8ZuWlwMHwUdSG8YvdifEotl7sWEostlYPx98IL0l73W1oXrKiKgEIG85U8NeejfPL3mkr31TAJCnpUzoFdIHis3984QsvPyA3LF2Uq+ZdkWRi9eg+QDhImpAfdOpg4opMWjKmDrylANKqQCNR4aTamvyFUX+yEp3BcqcYRY0uDT4jC8/J6vMOCh3hllYOVUD06Z6PBJ1sIHT7IanAvlBw3J6xjGGKTMAJVNKAKRGinNmmHkDi32nBjNOb406crxh1XZfG9+6HCUyzByVxPLyNAIzqaWlXVFs+K1n343DfBlmlnIBQOZbDkARsNIGivs/PIt/TmXLMLN98wiQQcQOKKY6pQ0UeRKVF1Cu41rbhh9Qj4w1BkU1uISqxsfP1WPaIqSx8SAakNo0G1n3vt+p8wzCzHqG1aZ77rRbNesuhrhmI1kAjVloYx+E4oCwavEMdPGk+IndvLUog3bT4+P9YMC+1BNNGCgenzxpVhl6sXNFMIJOWE8VzqfsQLFyT/gnjf4tgJgLUASLaSdq9GIwOuuBYrWZA5D8MwA0aIbpB4s2DLmzqrC4Y/m0k+4F5VGF0ibjapVwrGhDYx7hlhpKH5/iAQUU6Nx8VgioS1+dKG8ADSqRLvz6AG3lUcvkB4UVqWdlDTc9eCVO1GlYOHkBF2lcLZitw2JGmCpxok7Dwukvukj9UrNBf+5zbZtVJFMqFKQnHLffYMw/Ea3P4S3riToNcwZp24mPiERF26Hh1JaW0sS6w2UI0g4MLo2cWMpsNZ0VUB71Q2waIBe0awPkMBAl8gFyV6vAN/OcaLSh34uzudhM/eM9lyOr81Q+661BnVkCoLxaOSBvNz0Hn9UD8nbTM/BZFlBwAedpTfZDZzcMdxde6NsEFFPqxfhcCqBZwo39wNkNg92ltJv5ORUCFJRhlsRnbkJlAAVmmCXxmZlQEUClVqC6GkCl1jC7GkDF1jC7ohhUaA0zO5+S1Ar1YrOuYVa0Xq1+shrgqmhkWu8Fs1if+Rz2vWc3nN0dAYK+Li4Gzf2c1cvrxZxZL2nullSxySrIcGAXozKAApdnCHGaySbXocp8eIpTAjSPDQGa6VBlPjzFKQGax4YAzXSoMh+e4pQAzWNzmYCuSQQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgSUG1C3uo7vEVudjbwNab2NJFIhH71+tInHDV+LRT0pJfmBIZkBHXbi1mLTnk7jOqXOxv0Lx+NT+9GaF9rp52zi+aEkXwdBfNp7OkB5ATXynrRMRavsX2tn43nKklxHrS2e24828bgRi/byW53e00HKCqhhj+J8z6fvtjnV4ITbr9znpzNBbjgg5Mar3DFIAvI+g6zbUX3BvE+crO6fgR+xZihww5c8Qm68KgJItndnqxc2hx3P43M/MZCnQSI/rYnfTSPYATd+LQZotDmwUTHa7ac5913u2sFX/VkfoKAmJuRa11Km0Xr9mJm2nuUxeShbXRMDUdEEZO+ku988+PzUZuDx9PWtj/UFadCvGhDtX+t5mSKnH2XicaN3raebP6lT9Y/Mul6Mn7A1uu636l2nn7OJ2414XKOAs56Bov4ua9/YvrPhz5e2ho5a5oBxBy4/honTjbHLezp+0WQViAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCgVQHyPx3GujfPA2U8uiBAuT4SJwIEtBJAtciWP+y+38qElVqmru63f9u1G3vxrmRRd3n1XWrLjQCSzyd9POx44nP3j+dI7bciof7+mSfQCRadpcibktu3AEjkxKu/++0b+bq5fxaJZN1/bzgLbfnNO5ljdxuAVJKqKG37n0yXU+mX6j/xuG4jnbU5t7uCWgegLklVA+oWYrMAUumsbSi6//eN16DTmc2oBukdtwHoHIMkIF3qESBlKRP6b6aJif7o+LRRgMTrU9X93McEpCxl5RG/1bgJQHocpEY2/HVbScaA1DhIJPa2CG8F0HpFgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCg/wN1MUdLdRK+nAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb75-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb75-3" title="3">logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</a>
<a class="sourceLine" id="cb75-4" title="4">yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb75-5" title="5"><span class="kw">lines</span>(a, yhat3, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>))<span class="co">#cubic polynimial</span></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Cubic polynomial&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb76-3" title="3">yhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb76-4" title="4"><span class="kw">lines</span>(a, yhat4, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></a>
<a class="sourceLine" id="cb77-2" title="2">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb77-3" title="3"><span class="co"># for n-fold cross validation</span></a>
<a class="sourceLine" id="cb77-4" title="4"><span class="co"># fit models on leave-one-out samples</span></a>
<a class="sourceLine" id="cb77-5" title="5"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb77-6" title="6">  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb77-7" title="7">  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb77-8" title="8">  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb77-9" title="9">  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb77-10" title="10">  e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb77-11" title="11">  </a>
<a class="sourceLine" id="cb77-12" title="12">  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb77-13" title="13">  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></a>
<a class="sourceLine" id="cb77-14" title="14"><span class="st">    </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb77-15" title="15">  e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb77-16" title="16">  </a>
<a class="sourceLine" id="cb77-17" title="17">  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb77-18" title="18">  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb77-19" title="19">  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb77-20" title="20">  e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb77-21" title="21">  </a>
<a class="sourceLine" id="cb77-22" title="22">  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))<span class="co">#cubic polynomial</span></a>
<a class="sourceLine" id="cb77-23" title="23">  yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></a>
<a class="sourceLine" id="cb77-24" title="24"><span class="st">    </span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb77-25" title="25">  e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb77-26" title="26">}</a>
<a class="sourceLine" id="cb77-27" title="27"><span class="kw">data.frame</span>(<span class="st">&quot;MSE1&quot;</span>=<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>),<span class="st">&quot;MSE2&quot;</span>=<span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>),<span class="st">&quot;MSE3&quot;</span>=<span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>),<span class="st">&quot;MSE4&quot;</span>=<span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>),<span class="dt">row.names =</span> <span class="st">&quot;MSE from the n-fold cross validation.&quot;</span>)</a></code></pre></div>
<pre><code>##                                           MSE1     MSE2     MSE3     MSE4
## MSE from the n-fold cross validation. 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">data.frame</span>(<span class="st">&quot;R^2 of L2&quot;</span>=<span class="kw">summary</span>(J2)<span class="op">$</span>adj.r.squared,<span class="st">&quot;R^2 of L4&quot;</span>=<span class="kw">summary</span>(J4)<span class="op">$</span>adj.r.squared,<span class="dt">row.names =</span> <span class="st">&quot;maximum adjusted R^2&quot;</span>)</a></code></pre></div>
<pre><code>##                      R.2.of.L2 R.2.of.L4
## maximum adjusted R^2 0.5909726 0.5937184</code></pre>
<p>I replacing the Log-Log model with a cubic polynomial model.The L4 and J4 are both a cubic polynomial model.</p>
<p>From the results, the MSE of J4 equals 18.17756,which is also larger than the MSE of J2.Thus, we still choose the Quadratic model from MSE.</p>
<p>From the maximum adjusted R^2, we can find the maximum adjusted R^2 of J2 equals 0.59097 ,which is small than maximum adjusted R^2 of J4(0.59373).In this case,we will choose the cubic polynomial.</p>
</div>
</div>
<div id="homework-9" class="section level1">
<h1>Homework 9</h1>
<div id="section-9" class="section level2">
<h2>8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="solution-5" class="section level2">
<h2>Solution</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb81-2" title="2">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb81-3" title="3">z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</a>
<a class="sourceLine" id="cb81-4" title="4">R &lt;-<span class="st"> </span><span class="dv">999</span>;K &lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>;n&lt;-<span class="kw">length</span>(x);<span class="kw">set.seed</span>(<span class="dv">0374</span>)</a>
<a class="sourceLine" id="cb81-5" title="5">reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</a>
<a class="sourceLine" id="cb81-6" title="6"><span class="co">#define the count five test function</span></a>
<a class="sourceLine" id="cb81-7" title="7">count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) { </a>
<a class="sourceLine" id="cb81-8" title="8">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb81-9" title="9">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y) </a>
<a class="sourceLine" id="cb81-10" title="10">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y)) </a>
<a class="sourceLine" id="cb81-11" title="11">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X)) <span class="co"># return 1 (reject) or 0 (do not reject H0) </span></a>
<a class="sourceLine" id="cb81-12" title="12">  <span class="co">#return(as.integer(max(c(outx, outy)) &gt; 5)) </span></a>
<a class="sourceLine" id="cb81-13" title="13">  <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</a>
<a class="sourceLine" id="cb81-14" title="14">  }</a>
<a class="sourceLine" id="cb81-15" title="15">t0 &lt;-<span class="st"> </span><span class="kw">count5test</span>(x,y)</a>
<a class="sourceLine" id="cb81-16" title="16"><span class="co"># Implement a permutation test</span></a>
<a class="sourceLine" id="cb81-17" title="17"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){ </a>
<a class="sourceLine" id="cb81-18" title="18">  k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb81-19" title="19">  x1 &lt;-<span class="st"> </span>z[k]</a>
<a class="sourceLine" id="cb81-20" title="20">  y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] </a>
<a class="sourceLine" id="cb81-21" title="21">  reps[i] &lt;-<span class="st"> </span><span class="kw">count5test</span>(x1,y1) </a>
<a class="sourceLine" id="cb81-22" title="22">} </a>
<a class="sourceLine" id="cb81-23" title="23">p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(t0, reps)) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(t0)) </a>
<a class="sourceLine" id="cb81-24" title="24"><span class="kw">print</span>(p)</a></code></pre></div>
<pre><code>## [1] 0.03</code></pre>
<p>As code above, I implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal. the p-value is smaller than 0.05, Thus, we can’t say the two samples have same variance, which in line with the actual situation.</p>
</div>
<div id="discussion-1" class="section level2">
<h2>8.Discussion</h2>
<p>Power conparison (distance correlation test vs ball covariance test)</p>
<p>Model 1:<span class="math inline">\(Y=\frac X 4 + e\)</span></p>
<p>Model 2:<span class="math inline">\(Y=\frac X 4 * e\)</span></p>
<p><span class="math inline">\(x \sim N(0_2,I_2),~e\sim N(0_2,I_2)\)</span>,~X and e are independent</p>
</div>
<div id="solution-6" class="section level2">
<h2>Solution</h2>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="co">#Empirical distance covariance</span></a>
<a class="sourceLine" id="cb83-2" title="2">dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb83-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x); y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb83-4" title="4">  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x); m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb83-5" title="5">  <span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb83-6" title="6">  <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb83-7" title="7">    <span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb83-8" title="8">  Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb83-9" title="9">    d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb83-10" title="10">    m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d); M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb83-11" title="11">    a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m); b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb83-12" title="12">    b <span class="op">+</span><span class="st"> </span>M</a>
<a class="sourceLine" id="cb83-13" title="13">  }</a>
<a class="sourceLine" id="cb83-14" title="14">  A &lt;-<span class="st"> </span><span class="kw">Akl</span>(x); B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb83-15" title="15">  <span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb83-16" title="16">}</a>
<a class="sourceLine" id="cb83-17" title="17">ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb83-18" title="18">  <span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb83-19" title="19">  p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb83-20" title="20">  q &lt;-<span class="st"> </span>dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb83-21" title="21">  d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>q</a>
<a class="sourceLine" id="cb83-22" title="22">  x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb83-23" title="23">  y &lt;-<span class="st"> </span>z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)] <span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb83-24" title="24">  <span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb83-25" title="25">}</a>
<a class="sourceLine" id="cb83-26" title="26"></a>
<a class="sourceLine" id="cb83-27" title="27"><span class="kw">library</span>(<span class="st">&quot;boot&quot;</span>)</a>
<a class="sourceLine" id="cb83-28" title="28"><span class="co">#the function to generate random number of Model 1</span></a>
<a class="sourceLine" id="cb83-29" title="29">rd1 &lt;-<span class="st"> </span><span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb83-30" title="30">  x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n,<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb83-31" title="31">  e &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n,<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb83-32" title="32">  y &lt;-<span class="st"> </span><span class="fl">0.25</span><span class="op">*</span>x<span class="op">+</span>e</a>
<a class="sourceLine" id="cb83-33" title="33">  z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x,y)</a>
<a class="sourceLine" id="cb83-34" title="34">  <span class="kw">return</span>(z)</a>
<a class="sourceLine" id="cb83-35" title="35">}</a>
<a class="sourceLine" id="cb83-36" title="36"><span class="co">#the function to generate random number of Model 2</span></a>
<a class="sourceLine" id="cb83-37" title="37">rd2 &lt;-<span class="st"> </span><span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb83-38" title="38">  x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n,<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb83-39" title="39">  e &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n,<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb83-40" title="40">  y &lt;-<span class="st"> </span><span class="fl">0.25</span><span class="op">*</span>x<span class="op">*</span>e</a>
<a class="sourceLine" id="cb83-41" title="41">  z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x,y)</a>
<a class="sourceLine" id="cb83-42" title="42">  <span class="kw">return</span>(z)</a>
<a class="sourceLine" id="cb83-43" title="43">}</a>
<a class="sourceLine" id="cb83-44" title="44"><span class="co">#obtain p-value of disrance correlation</span></a>
<a class="sourceLine" id="cb83-45" title="45">p.dcf &lt;-<span class="st"> </span><span class="cf">function</span>(z){</a>
<a class="sourceLine" id="cb83-46" title="46">  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb83-47" title="47">                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb83-48" title="48">  tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0, boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb83-49" title="49">  p.cov &lt;-<span class="st"> </span><span class="kw">mean</span>(tb<span class="op">&gt;=</span>tb[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb83-50" title="50">  <span class="kw">return</span>(p.cov)</a>
<a class="sourceLine" id="cb83-51" title="51">}</a>
<a class="sourceLine" id="cb83-52" title="52"><span class="co">#obtain p-value of ball covariance test</span></a>
<a class="sourceLine" id="cb83-53" title="53">p.bcf &lt;-<span class="st"> </span><span class="cf">function</span>(z){</a>
<a class="sourceLine" id="cb83-54" title="54">  p.bc &lt;-<span class="st"> </span><span class="kw">bcov.test</span>(z[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],z[,<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">R=</span><span class="dv">100</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb83-55" title="55">  <span class="kw">return</span>(p.bc)</a>
<a class="sourceLine" id="cb83-56" title="56">}</a>
<a class="sourceLine" id="cb83-57" title="57"></a>
<a class="sourceLine" id="cb83-58" title="58"><span class="kw">library</span>(MASS)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb86-2" title="2">m &lt;-<span class="st"> </span><span class="dv">50</span>;p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb86-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb86-4" title="4">  p.values[i,<span class="dv">1</span>] &lt;-<span class="kw">p.dcf</span>(<span class="kw">rd1</span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb86-5" title="5">  p.values[i,<span class="dv">2</span>] &lt;-<span class="kw">p.dcf</span>(<span class="kw">rd1</span>(<span class="dv">50</span>))</a>
<a class="sourceLine" id="cb86-6" title="6">  p.values[i,<span class="dv">3</span>] &lt;-<span class="kw">p.dcf</span>(<span class="kw">rd1</span>(<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb86-7" title="7">}</a>
<a class="sourceLine" id="cb86-8" title="8">pow1_dc &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="co">#power of DC in model 1</span></a>
<a class="sourceLine" id="cb86-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb86-10" title="10">  p.values[i,<span class="dv">1</span>] &lt;-<span class="kw">p.bcf</span>(<span class="kw">rd1</span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb86-11" title="11">  p.values[i,<span class="dv">2</span>] &lt;-<span class="kw">p.bcf</span>(<span class="kw">rd1</span>(<span class="dv">50</span>))</a>
<a class="sourceLine" id="cb86-12" title="12">  p.values[i,<span class="dv">3</span>] &lt;-<span class="kw">p.bcf</span>(<span class="kw">rd1</span>(<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb86-13" title="13">}</a>
<a class="sourceLine" id="cb86-14" title="14">pow1_bc &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="co">#power of BC in model 1</span></a>
<a class="sourceLine" id="cb86-15" title="15"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb86-16" title="16">  p.values[i,<span class="dv">1</span>] &lt;-<span class="kw">p.dcf</span>(<span class="kw">rd2</span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb86-17" title="17">  p.values[i,<span class="dv">2</span>] &lt;-<span class="kw">p.dcf</span>(<span class="kw">rd2</span>(<span class="dv">50</span>))</a>
<a class="sourceLine" id="cb86-18" title="18">  p.values[i,<span class="dv">3</span>] &lt;-<span class="kw">p.dcf</span>(<span class="kw">rd2</span>(<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb86-19" title="19">}</a>
<a class="sourceLine" id="cb86-20" title="20">pow2_dc &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="co">#power of DC in model 2</span></a>
<a class="sourceLine" id="cb86-21" title="21"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb86-22" title="22">  p.values[i,<span class="dv">1</span>] &lt;-<span class="kw">p.bcf</span>(<span class="kw">rd2</span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb86-23" title="23">  p.values[i,<span class="dv">2</span>] &lt;-<span class="kw">p.bcf</span>(<span class="kw">rd2</span>(<span class="dv">50</span>))</a>
<a class="sourceLine" id="cb86-24" title="24">  p.values[i,<span class="dv">3</span>] &lt;-<span class="kw">p.bcf</span>(<span class="kw">rd2</span>(<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb86-25" title="25">}</a>
<a class="sourceLine" id="cb86-26" title="26">pow2_bc &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="co">#power of BC in model 2</span></a>
<a class="sourceLine" id="cb86-27" title="27">N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb86-28" title="28"><span class="kw">data.frame</span>(N,pow1_dc,pow1_bc,pow2_dc,pow2_bc)</a></code></pre></div>
<pre><code>##     N pow1_dc pow1_bc pow2_dc pow2_bc
## 1  10    0.10    0.08    0.20    0.26
## 2  50    0.52    0.24    0.50    0.94
## 3 100    0.74    0.36    0.74    1.00</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">plot</span>(N,pow1_dc,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main =</span> <span class="st">&quot;power comparison in model 1: Y=X/4+e&quot;</span>)</a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">lines</span>(N,pow1_bc,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb88-3" title="3"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;ball covariance&quot;</span>,<span class="st">&quot;distance correlation&quot;</span>),</a>
<a class="sourceLine" id="cb88-4" title="4">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">1</span>)  </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">plot</span>(N,pow2_dc,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main =</span> <span class="st">&quot;power comparison in model 2: Y=X/4*e&quot;</span>)</a>
<a class="sourceLine" id="cb89-2" title="2"><span class="kw">lines</span>(N,pow2_bc,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb89-3" title="3"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;ball covariance&quot;</span>,<span class="st">&quot;distance correlation&quot;</span>),</a>
<a class="sourceLine" id="cb89-4" title="4">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">1</span>)  </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As the code above, for each model, I choose three kind of sample size (10、50、100) to compare the power of each method.</p>
<p>In the model <span class="math inline">\(y=\frac x4+e\)</span>, we can find the power of distance correlation is always larger than that of ball covariance. On the countrary, in the model <span class="math inline">\(y=\frac x4 *e\)</span>, the method ball covariance peform better than distance correlation.</p>
</div>
</div>
<div id="homework-10" class="section level1">
<h1>Homework 10</h1>
<div id="section-10" class="section level2">
<h2>9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain</p>
</div>
<div id="solution-7" class="section level2">
<h2>solution</h2>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x) = \frac1 2e^{−|x|}\)</span></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">dt&lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb90-2" title="2"></a>
<a class="sourceLine" id="cb90-3" title="3">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>( sigma, x0, N) {</a>
<a class="sourceLine" id="cb90-4" title="4">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb90-5" title="5">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb90-6" title="6">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb90-7" title="7">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb90-8" title="8">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb90-9" title="9">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb90-10" title="10">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dt</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">dt</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb90-11" title="11">      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb90-12" title="12">        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb90-13" title="13">        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb90-14" title="14">      }</a>
<a class="sourceLine" id="cb90-15" title="15">  }</a>
<a class="sourceLine" id="cb90-16" title="16">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb90-17" title="17">}</a>
<a class="sourceLine" id="cb90-18" title="18"></a>
<a class="sourceLine" id="cb90-19" title="19">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb90-20" title="20">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb90-21" title="21">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb90-22" title="22">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb90-23" title="23">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb90-24" title="24">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb90-25" title="25">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb90-26" title="26"></a>
<a class="sourceLine" id="cb90-27" title="27"></a>
<a class="sourceLine" id="cb90-28" title="28">q1 &lt;-<span class="st"> </span><span class="kw">log10</span>(<span class="dv">1-2</span><span class="op">*</span><span class="kw">abs</span>(<span class="fl">0.025-0.5</span>))<span class="co">#the 0.025 quantile of Laplace distribution</span></a>
<a class="sourceLine" id="cb90-29" title="29">q2 &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log10</span>(<span class="dv">1-2</span><span class="op">*</span><span class="kw">abs</span>(<span class="fl">0.975-0.5</span>))<span class="co">#the 0.975 quantile of Laplace distribution </span></a>
<a class="sourceLine" id="cb90-30" title="30">qs &lt;-<span class="st"> </span><span class="kw">c</span>(q1,q2)</a>
<a class="sourceLine" id="cb90-31" title="31">rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb90-32" title="32"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb90-33" title="33">  <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb90-34" title="34">       <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb90-35" title="35">       <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</a>
<a class="sourceLine" id="cb90-36" title="36">  <span class="kw">abline</span>(<span class="dt">h=</span>qs)</a>
<a class="sourceLine" id="cb90-37" title="37">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">ac &lt;-<span class="st"> </span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)</a>
<a class="sourceLine" id="cb91-2" title="2">ac.rate &lt;-<span class="st"> </span>(N<span class="op">-</span>ac)<span class="op">/</span>N</a>
<a class="sourceLine" id="cb91-3" title="3"><span class="kw">rbind</span>(sigma, ac.rate)<span class="co">#the acceptance rates of each chain</span></a></code></pre></div>
<pre><code>##         [,1]  [,2]  [,3]    [,4]
## sigma   0.05 0.500 2.000 16.0000
## ac.rate 0.98 0.834 0.539  0.0945</code></pre>
<p>We can find the third one (<span class="math inline">\(\sigma = 2)\)</span> performs better than others. And the acceptance rate is about 0.5.</p>
</div>
</div>
<div id="homework-11" class="section level1">
<h1>Homework 11</h1>
<div id="section-11" class="section level2">
<h2>11.1</h2>
<p>The natural logarithm and exponential functions are inverses of each other, so that mathematically log(exp x) = exp(log x) = x. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw">log</span>(<span class="kw">exp</span>(<span class="dv">5</span>))</a></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">5</span>))</a></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="kw">log</span>(<span class="kw">exp</span>(<span class="dv">5</span>))<span class="op">-</span><span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">5</span>))</a></code></pre></div>
<pre><code>## [1] 8.881784e-16</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">log</span>(<span class="kw">exp</span>(<span class="dv">5</span>)),<span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">5</span>))))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>We can find the difference of <span class="math inline">\(log(e^5)-e^{log(5)}\)</span> equls <span class="math inline">\(8.88*10^{-16}\)</span>, which is not equal to 0. So this property does not hold exactly in computer arithmetic.</p>
<p>But the difference is samll than the tolerance(=1.490116e-08). So the identity hold with near equality (in all.equal)</p>
</div>
<div id="section-12" class="section level2">
<h2>11.5</h2>
<p>Write a function to solve the equation $  <em>{0}<sup>{c_{k-1}}(1+)</sup>{-k / 2} d u =  </em>{0}<sup>{c_{k}}(1+)</sup>{-(k+1) / 2} d u $ for <span class="math inline">\(a\)</span>, where <span class="math inline">\(c_k=\sqrt{\frac{a^2 k}{k+1-a^2}}\)</span> Compare the solutions with the points A(k) in Exercise 11.4</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">ks  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb101-2" title="2">n &lt;-<span class="st"> </span><span class="kw">length</span>(ks)</a>
<a class="sourceLine" id="cb101-3" title="3">A1 &lt;-<span class="st"> </span>A2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb101-4" title="4">cf &lt;-<span class="st"> </span><span class="cf">function</span>(k,a){</a>
<a class="sourceLine" id="cb101-5" title="5">  <span class="kw">return</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb101-6" title="6">}</a>
<a class="sourceLine" id="cb101-7" title="7"></a>
<a class="sourceLine" id="cb101-8" title="8">f1 &lt;-<span class="st"> </span><span class="cf">function</span>(u){</a>
<a class="sourceLine" id="cb101-9" title="9">  (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb101-10" title="10">}</a>
<a class="sourceLine" id="cb101-11" title="11">f2 &lt;-<span class="st"> </span><span class="cf">function</span>(u){which</a>
<a class="sourceLine" id="cb101-12" title="12">  (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb101-13" title="13">}</a>
<a class="sourceLine" id="cb101-14" title="14">g1 &lt;-<span class="st"> </span><span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb101-15" title="15">  <span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">*</span><span class="kw">gamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(f1,<span class="dv">0</span>,<span class="kw">cf</span>(k<span class="dv">-1</span>,a))<span class="op">$</span>value<span class="dv">-2</span><span class="op">*</span><span class="kw">gamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(f2,<span class="dv">0</span>,<span class="kw">cf</span>(k,a))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb101-16" title="16">}<span class="co">#soluton of question 11.5 </span></a>
<a class="sourceLine" id="cb101-17" title="17">g2 &lt;-<span class="st"> </span><span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb101-18" title="18">  <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">cf</span>(k<span class="dv">-1</span>,a),k<span class="dv">-1</span>)<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="kw">pt</span>(<span class="kw">cf</span>(k,a),k)</a>
<a class="sourceLine" id="cb101-19" title="19">} <span class="co">#solution of question 11.4</span></a>
<a class="sourceLine" id="cb101-20" title="20"></a>
<a class="sourceLine" id="cb101-21" title="21"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb101-22" title="22">  k &lt;-<span class="st"> </span>ks[i]</a>
<a class="sourceLine" id="cb101-23" title="23">  A1[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(g1,<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb101-24" title="24">  A2[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(g2,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb101-25" title="25">}</a>
<a class="sourceLine" id="cb101-26" title="26">A1</a></code></pre></div>
<pre><code>##  [1] 1.492104 1.533559 1.562745 1.584428 1.601182 1.614529 1.625383 1.634409
##  [9] 1.642028 1.648537 1.654188 1.659121 1.663434 1.667304 1.670732 1.673816
## [17] 1.676604 1.679153 1.681483 1.683594 1.685546 1.687356 1.720599</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">A2</a></code></pre></div>
<pre><code>##  [1] 1.492103 1.533576 1.562721 1.584427 1.601166 1.614524 1.625385 1.634415
##  [9] 1.642027 1.648536 1.654175 1.659097 1.663408 1.667301 1.670724 1.673819
## [17] 1.676589 1.679154 1.681470 1.683610 1.685548 1.687347 1.720610</code></pre>
</div>
<div id="a-b-o-blood-type-problem" class="section level2">
<h2>A-B-O blood type problem</h2>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="kw">library</span>(rootSolve)</a>
<a class="sourceLine" id="cb105-2" title="2"><span class="kw">set.seed</span>(<span class="dv">013</span>)</a>
<a class="sourceLine" id="cb105-3" title="3">N &lt;-<span class="st"> </span><span class="fl">2e2</span></a>
<a class="sourceLine" id="cb105-4" title="4">nA &lt;-<span class="st"> </span><span class="dv">28</span>  </a>
<a class="sourceLine" id="cb105-5" title="5">nB &lt;-<span class="st"> </span><span class="dv">24</span></a>
<a class="sourceLine" id="cb105-6" title="6">nO &lt;-<span class="st"> </span><span class="dv">41</span></a>
<a class="sourceLine" id="cb105-7" title="7">nAB&lt;-<span class="dv">70</span>  </a>
<a class="sourceLine" id="cb105-8" title="8">E &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb105-9" title="9">L &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>)<span class="co">#setting Initial value</span></a>
<a class="sourceLine" id="cb105-10" title="10">tol &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb105-11" title="11">L.old &lt;-<span class="st"> </span>L<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb105-12" title="12"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb105-13" title="13">  E[j]&lt;-<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>nA<span class="op">*</span><span class="kw">log</span>(L[<span class="dv">1</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb105-14" title="14">  <span class="op">+</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">*</span>nB<span class="op">*</span><span class="kw">log</span>(L[<span class="dv">2</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb105-15" title="15">  <span class="op">+</span><span class="dv">2</span><span class="op">*</span>nO<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb105-16" title="16">  <span class="op">+</span>nA<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>]))<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb105-17" title="17">  <span class="op">+</span>nB<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>]))<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb105-18" title="18">  <span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>L[<span class="dv">2</span>])<span class="co">#E-step expression</span></a>
<a class="sourceLine" id="cb105-19" title="19">  model&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb105-20" title="20">    <span class="co">#use R.function multiroot to  solve the max for M-step</span></a>
<a class="sourceLine" id="cb105-21" title="21">    F1&lt;-<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>nA<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>x[<span class="dv">1</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nO<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">+</span>nA<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1-2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">-</span>nB<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>nAB<span class="op">/</span>x[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb105-22" title="22">    F2&lt;-<span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">*</span>nB<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">*</span>x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nO<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">-</span>nA<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>nB<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1-2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">-</span>x[<span class="dv">1</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>nAB<span class="op">/</span>x[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb105-23" title="23">    <span class="kw">c</span>(<span class="dt">F1=</span>F1,<span class="dt">F2=</span>F2)</a>
<a class="sourceLine" id="cb105-24" title="24">  }</a>
<a class="sourceLine" id="cb105-25" title="25">  tt&lt;-<span class="kw">multiroot</span>(<span class="dt">f=</span>model,<span class="dt">star=</span><span class="kw">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb105-26" title="26">  L&lt;-tt<span class="op">$</span>root</a>
<a class="sourceLine" id="cb105-27" title="27">  <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(L<span class="op">-</span>L.old)<span class="op">/</span>L.old)<span class="op">&lt;</span>tol) <span class="cf">break</span></a>
<a class="sourceLine" id="cb105-28" title="28">  L.old&lt;-L</a>
<a class="sourceLine" id="cb105-29" title="29">}</a>
<a class="sourceLine" id="cb105-30" title="30"><span class="kw">data.frame</span>(<span class="st">&quot;p-hat&quot;</span> =<span class="st"> </span>L.old[<span class="dv">1</span>],<span class="st">&quot;q-hat&quot;</span> =<span class="st"> </span>L.old[<span class="dv">2</span>])</a></code></pre></div>
<pre><code>##       p.hat     q.hat
## 1 0.3273442 0.3104267</code></pre>
</div>
</div>
<div id="homework-12" class="section level1">
<h1>Homework 12</h1>
<div id="q3" class="section level2">
<h2>Q3</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:<br />
formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="kw">data</span>(<span class="st">&quot;mtcars&quot;</span>)</a>
<a class="sourceLine" id="cb107-2" title="2"><span class="kw">attach</span>(mtcars)</a>
<a class="sourceLine" id="cb107-3" title="3">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb107-4" title="4">  mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb107-5" title="5">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb107-6" title="6">  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb107-7" title="7">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb107-8" title="8">)</a>
<a class="sourceLine" id="cb107-9" title="9"><span class="co">#for loop</span></a>
<a class="sourceLine" id="cb107-10" title="10">out_loop_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))</a>
<a class="sourceLine" id="cb107-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)) {</a>
<a class="sourceLine" id="cb107-12" title="12">  out_loop_<span class="dv">1</span>[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]])</a>
<a class="sourceLine" id="cb107-13" title="13">}</a>
<a class="sourceLine" id="cb107-14" title="14">out_loop_<span class="dv">1</span></a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="co">#lapply</span></a>
<a class="sourceLine" id="cb109-2" title="2">out_lap_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, lm)</a>
<a class="sourceLine" id="cb109-3" title="3">out_lap_<span class="dv">1</span></a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="q4" class="section level2">
<h2>Q4</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function? bootstraps &lt;- lapply(1:10, function(i) { rows &lt;- sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb111-2" title="2">  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb111-3" title="3">  mtcars[rows, ]</a>
<a class="sourceLine" id="cb111-4" title="4">})</a>
<a class="sourceLine" id="cb111-5" title="5"><span class="co">#for loop</span></a>
<a class="sourceLine" id="cb111-6" title="6">out_loop_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(bootstraps))</a>
<a class="sourceLine" id="cb111-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)) {</a>
<a class="sourceLine" id="cb111-8" title="8">  f &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw">lm</span>(mpg<span class="op">~</span>disp, <span class="dt">data=</span>x)}</a>
<a class="sourceLine" id="cb111-9" title="9">  out_loop_<span class="dv">2</span>[[i]] &lt;-<span class="st"> </span><span class="kw">f</span>(bootstraps[[i]])</a>
<a class="sourceLine" id="cb111-10" title="10">}</a>
<a class="sourceLine" id="cb111-11" title="11">out_loop_<span class="dv">2</span></a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##     27.7921      -0.0354  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##     27.2344      -0.0354  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.32630     -0.04227  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.66946     -0.03525  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.53873     -0.03733  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.10282     -0.04507  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.05059     -0.03649  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.29673     -0.04184  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.05962     -0.03704  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.69104     -0.03534</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="co">#lapply</span></a>
<a class="sourceLine" id="cb113-2" title="2">out_lap_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">lapply</span>(bootstraps, lm, <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp)</a>
<a class="sourceLine" id="cb113-3" title="3">out_lap_<span class="dv">2</span></a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     27.7921      -0.0354  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     27.2344      -0.0354  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.32630     -0.04227  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.66946     -0.03525  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.53873     -0.03733  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.10282     -0.04507  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.05059     -0.03649  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.29673     -0.04184  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.05962     -0.03704  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.69104     -0.03534</code></pre>
</div>
<div id="q5" class="section level2">
<h2>Q5</h2>
<p>For each model in the previous two exercises, extract R2 using the function below. rsq &lt;- function(mod) summary(mod)$r.squared</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb115-2" title="2"><span class="co">#for exercises 1</span></a>
<a class="sourceLine" id="cb115-3" title="3"><span class="kw">unlist</span>(<span class="kw">lapply</span>(out_loop_<span class="dv">1</span>, rsq))</a></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">unlist</span>(<span class="kw">lapply</span>(out_lap_<span class="dv">1</span>, rsq))</a></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="co">#for exercise 2</span></a>
<a class="sourceLine" id="cb119-2" title="2"><span class="kw">unlist</span>(<span class="kw">lapply</span>(out_loop_<span class="dv">2</span>, rsq))</a></code></pre></div>
<pre><code>##  [1] 0.7466049 0.6552023 0.7588687 0.6643541 0.6227079 0.7468863 0.6630090
##  [8] 0.7530685 0.8654666 0.5655179</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">unlist</span>(<span class="kw">lapply</span>(out_lap_<span class="dv">2</span>, rsq))</a></code></pre></div>
<pre><code>##  [1] 0.7466049 0.6552023 0.7588687 0.6643541 0.6227079 0.7468863 0.6630090
##  [8] 0.7530685 0.8654666 0.5655179</code></pre>
</div>
<div id="section-13" class="section level2">
<h2>3</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [[ directly.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb123-2" title="2">  <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb123-3" title="3">  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb123-4" title="4">  <span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb123-5" title="5">)</a>
<a class="sourceLine" id="cb123-6" title="6"><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</a></code></pre></div>
<pre><code>##   [1] 0.235841949 0.096560532 0.894755916 0.708688088 0.245734311 0.181215419
##   [7] 0.921984628 0.495585287 0.890295360 0.956238384 0.490633486 0.490637398
##  [13] 0.105610602 0.948832294 0.734326887 0.308321558 0.587918063 0.767493027
##  [19] 0.809105412 0.729581515 0.196121865 0.968883237 0.607984572 0.151373478
##  [25] 0.250295618 0.305379416 0.490322080 0.725864083 0.141374058 0.591155906
##  [31] 0.626247915 0.823475499 0.891936026 0.027148663 0.172480132 0.816507745
##  [37] 0.437229459 0.149543115 0.390712565 0.252497294 0.480215778 0.815936243
##  [43] 0.800206688 0.345960804 0.971434598 0.712655403 0.716716152 0.375674241
##  [49] 0.015933403 0.346531083 0.346791451 0.143253982 0.378345660 0.740441925
##  [55] 0.908493720 0.020462921 0.417890079 0.122305785 0.697349329 0.941964749
##  [61] 0.925479929 0.309492782 0.189625459 0.924339976 0.032382027 0.412550340
##  [67] 0.839649208 0.745070963 0.726842952 0.928623671 0.660399788 0.229652432
##  [73] 0.427535051 0.242594630 0.551711750 0.853717482 0.671426061 0.010678324
##  [79] 0.794306150 0.199298729 0.874251680 0.810184508 0.323470513 0.894457938
##  [85] 0.726998387 0.177767369 0.859626145 0.564877902 0.994114238 0.760363413
##  [91] 0.001183470 0.961009726 0.707243841 0.877548721 0.743193400 0.132386750
##  [97] 0.003894067 0.933125970 0.021753166 0.273243279</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="co">#get rid of the anonymous function</span></a>
<a class="sourceLine" id="cb125-2" title="2"><span class="kw">sapply</span>(trials, <span class="st">&quot;[[&quot;</span> , <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   [1] 0.235841949 0.096560532 0.894755916 0.708688088 0.245734311 0.181215419
##   [7] 0.921984628 0.495585287 0.890295360 0.956238384 0.490633486 0.490637398
##  [13] 0.105610602 0.948832294 0.734326887 0.308321558 0.587918063 0.767493027
##  [19] 0.809105412 0.729581515 0.196121865 0.968883237 0.607984572 0.151373478
##  [25] 0.250295618 0.305379416 0.490322080 0.725864083 0.141374058 0.591155906
##  [31] 0.626247915 0.823475499 0.891936026 0.027148663 0.172480132 0.816507745
##  [37] 0.437229459 0.149543115 0.390712565 0.252497294 0.480215778 0.815936243
##  [43] 0.800206688 0.345960804 0.971434598 0.712655403 0.716716152 0.375674241
##  [49] 0.015933403 0.346531083 0.346791451 0.143253982 0.378345660 0.740441925
##  [55] 0.908493720 0.020462921 0.417890079 0.122305785 0.697349329 0.941964749
##  [61] 0.925479929 0.309492782 0.189625459 0.924339976 0.032382027 0.412550340
##  [67] 0.839649208 0.745070963 0.726842952 0.928623671 0.660399788 0.229652432
##  [73] 0.427535051 0.242594630 0.551711750 0.853717482 0.671426061 0.010678324
##  [79] 0.794306150 0.199298729 0.874251680 0.810184508 0.323470513 0.894457938
##  [85] 0.726998387 0.177767369 0.859626145 0.564877902 0.994114238 0.760363413
##  [91] 0.001183470 0.961009726 0.707243841 0.877548721 0.743193400 0.132386750
##  [97] 0.003894067 0.933125970 0.021753166 0.273243279</code></pre>
</div>
<div id="section-14" class="section level2">
<h2>7</h2>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="co">#definite mcsapply</span></a>
<a class="sourceLine" id="cb127-2" title="2">mcsapply &lt;-<span class="st"> </span><span class="cf">function</span> (FUN, ..., <span class="dt">MoreArgs =</span> <span class="ot">NULL</span>, <span class="dt">SIMPLIFY =</span> <span class="ot">TRUE</span>, <span class="dt">USE.NAMES =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb127-3" title="3">{</a>
<a class="sourceLine" id="cb127-4" title="4">  FUN &lt;-<span class="st"> </span><span class="kw">match.fun</span>(FUN)</a>
<a class="sourceLine" id="cb127-5" title="5">  dots &lt;-<span class="st"> </span><span class="kw">list</span>(...)</a>
<a class="sourceLine" id="cb127-6" title="6">  answer &lt;-<span class="st"> </span><span class="kw">.Internal</span>(<span class="kw">mapply</span>(FUN, dots, MoreArgs))</a>
<a class="sourceLine" id="cb127-7" title="7">  <span class="cf">if</span> (USE.NAMES <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(dots)) {</a>
<a class="sourceLine" id="cb127-8" title="8">    <span class="cf">if</span> (<span class="kw">is.null</span>(names1 &lt;-<span class="st"> </span><span class="kw">names</span>(dots[[1L]])) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(dots[[1L]])) </a>
<a class="sourceLine" id="cb127-9" title="9">      <span class="kw">names</span>(answer) &lt;-<span class="st"> </span>dots[[1L]]</a>
<a class="sourceLine" id="cb127-10" title="10">    <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(names1)) </a>
<a class="sourceLine" id="cb127-11" title="11">      <span class="kw">names</span>(answer) &lt;-<span class="st"> </span>names1</a>
<a class="sourceLine" id="cb127-12" title="12">  }</a>
<a class="sourceLine" id="cb127-13" title="13">  <span class="cf">if</span> (<span class="op">!</span><span class="kw">isFALSE</span>(SIMPLIFY) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(answer)) </a>
<a class="sourceLine" id="cb127-14" title="14">    <span class="kw">simplify2array</span>(answer, <span class="dt">higher =</span> (SIMPLIFY <span class="op">==</span><span class="st"> &quot;array&quot;</span>))</a>
<a class="sourceLine" id="cb127-15" title="15">  <span class="cf">else</span> answer</a>
<a class="sourceLine" id="cb127-16" title="16">}</a>
<a class="sourceLine" id="cb127-17" title="17"><span class="co">#example</span></a>
<a class="sourceLine" id="cb127-18" title="18">xs &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">5</span>, <span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb127-19" title="19">ws &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">5</span>, <span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb127-20" title="20"><span class="kw">sapply</span>(<span class="kw">seq_along</span>(xs), <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb127-21" title="21">  <span class="kw">weighted.mean</span>(xs[[i]], ws[[i]])</a>
<a class="sourceLine" id="cb127-22" title="22">})</a></code></pre></div>
<pre><code>## [1] 0.5325397 0.4231833 0.4019994 0.6421098 0.4715099</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="kw">mcsapply</span>(weighted.mean, xs, ws)</a></code></pre></div>
<pre><code>## [1] 0.5325397 0.4231833 0.4019994 0.6421098 0.4715099</code></pre>
<p>I’m sorry that I don’t know how to peform mcvapply</p>
</div>
</div>
<div id="homework-13" class="section level1">
<h1>Homework 13</h1>
<div id="hw-ar2" class="section level2">
<h2>HW-AR2</h2>
<p>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R).Rewrite an Rcpp function for the same task.</p>
<p>Compare the generated random numbers by the two functions using <strong>qqplot</strong>.</p>
<p>Campare the computation time of the two functions with <strong>microbenchmark</strong>.</p>
<p>Comments your results.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="co">#setting</span></a>
<a class="sourceLine" id="cb131-2" title="2">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb131-3" title="3">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb131-4" title="4">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a></code></pre></div>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="co">#for R</span></a>
<a class="sourceLine" id="cb132-2" title="2">dt&lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb132-3" title="3"></a>
<a class="sourceLine" id="cb132-4" title="4">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>( sigma, x0, N) {</a>
<a class="sourceLine" id="cb132-5" title="5">  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb132-6" title="6">  x[<span class="dv">1</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb132-7" title="7">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb132-8" title="8">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb132-9" title="9">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb132-10" title="10">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dt</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">dt</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb132-11" title="11">      {</a>
<a class="sourceLine" id="cb132-12" title="12">        x[i,<span class="dv">1</span>] &lt;-<span class="st"> </span>y </a>
<a class="sourceLine" id="cb132-13" title="13">        x[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb132-14" title="14">      }</a>
<a class="sourceLine" id="cb132-15" title="15">    <span class="cf">else</span> </a>
<a class="sourceLine" id="cb132-16" title="16">      {</a>
<a class="sourceLine" id="cb132-17" title="17">        x[i,<span class="dv">1</span>] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb132-18" title="18">        x[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb132-19" title="19">      }</a>
<a class="sourceLine" id="cb132-20" title="20">  }</a>
<a class="sourceLine" id="cb132-21" title="21">  <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb132-22" title="22">}</a></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="co">#for Rcpp</span></a>
<a class="sourceLine" id="cb133-2" title="2"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb133-3" title="3"><span class="kw">sourceCpp</span>(<span class="dt">code =</span> <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb133-4" title="4"><span class="st">          #include &lt;Rcpp.h&gt;</span></a>
<a class="sourceLine" id="cb133-5" title="5"><span class="st">          using namespace Rcpp;</span></a>
<a class="sourceLine" id="cb133-6" title="6"><span class="st">          //[[Rcpp::export]]</span></a>
<a class="sourceLine" id="cb133-7" title="7"><span class="st">          NumericMatrix randomwalkC(double sigma,double x0,int N){</span></a>
<a class="sourceLine" id="cb133-8" title="8"><span class="st">          NumericMatrix x(N,2);</span></a>
<a class="sourceLine" id="cb133-9" title="9"><span class="st">          x(0,0) = x0; </span></a>
<a class="sourceLine" id="cb133-10" title="10"><span class="st">          NumericVector u = runif(N); </span></a>
<a class="sourceLine" id="cb133-11" title="11"><span class="st">          for (int i = 1; i &lt; N ;i++){ </span></a>
<a class="sourceLine" id="cb133-12" title="12"><span class="st">            double y = as&lt;double&gt;(rnorm(1, x(i-1,0), sigma));</span></a>
<a class="sourceLine" id="cb133-13" title="13"><span class="st">            double t = exp(-abs(y))/exp(-abs(x(i-1,0)));</span></a>
<a class="sourceLine" id="cb133-14" title="14"><span class="st">            if (u[i] &lt;= t){</span></a>
<a class="sourceLine" id="cb133-15" title="15"><span class="st">              x(i,0) = x(i-1,0); </span></a>
<a class="sourceLine" id="cb133-16" title="16"><span class="st">              x(i,1) = 1;</span></a>
<a class="sourceLine" id="cb133-17" title="17"><span class="st">            }</span></a>
<a class="sourceLine" id="cb133-18" title="18"><span class="st">            else{ </span></a>
<a class="sourceLine" id="cb133-19" title="19"><span class="st">              x(i,0) = y;</span></a>
<a class="sourceLine" id="cb133-20" title="20"><span class="st">              x(i,1) = 0;} </span></a>
<a class="sourceLine" id="cb133-21" title="21"><span class="st">          };</span></a>
<a class="sourceLine" id="cb133-22" title="22"><span class="st">          return x;</span></a>
<a class="sourceLine" id="cb133-23" title="23"><span class="st">          }&#39;</span>)</a></code></pre></div>
<div id="compare-the-generated-random-numbers-by-the-two-functions-using-qqplot" class="section level3">
<h3>Compare the generated random numbers by the two functions using qqplot</h3>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="co">#random numbers from R</span></a>
<a class="sourceLine" id="cb134-2" title="2">rw1.R &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb134-3" title="3">rw2.R &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb134-4" title="4">rw3.R &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb134-5" title="5">rw4.R &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb134-6" title="6"><span class="co">#random numbers from Rcpp</span></a>
<a class="sourceLine" id="cb134-7" title="7">rw1.C &lt;-<span class="st"> </span><span class="kw">randomwalkC</span>( sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb134-8" title="8">rw2.C &lt;-<span class="st"> </span><span class="kw">randomwalkC</span>( sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb134-9" title="9">rw3.C &lt;-<span class="st"> </span><span class="kw">randomwalkC</span>( sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb134-10" title="10">rw4.C &lt;-<span class="st"> </span><span class="kw">randomwalkC</span>( sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb134-11" title="11"><span class="co">#effective rw</span></a>
<a class="sourceLine" id="cb134-12" title="12">r1.R &lt;-<span class="st"> </span>rw1.R[rw1.R[,<span class="dv">2</span>]<span class="op">==</span><span class="dv">1</span>,<span class="dv">1</span>]; r1.C &lt;-<span class="st"> </span>rw1.C[rw1.C[,<span class="dv">2</span>]<span class="op">==</span><span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb134-13" title="13">r2.R &lt;-<span class="st"> </span>rw2.R[rw2.R[,<span class="dv">2</span>]<span class="op">==</span><span class="dv">1</span>,<span class="dv">1</span>]; r2.C &lt;-<span class="st"> </span>rw2.C[rw2.C[,<span class="dv">2</span>]<span class="op">==</span><span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb134-14" title="14">r3.R &lt;-<span class="st"> </span>rw3.R[rw3.R[,<span class="dv">2</span>]<span class="op">==</span><span class="dv">1</span>,<span class="dv">1</span>]; r3.C &lt;-<span class="st"> </span>rw3.C[rw3.C[,<span class="dv">2</span>]<span class="op">==</span><span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb134-15" title="15">r4.R &lt;-<span class="st"> </span>rw4.R[rw4.R[,<span class="dv">2</span>]<span class="op">==</span><span class="dv">1</span>,<span class="dv">1</span>]; r4.C &lt;-<span class="st"> </span>rw4.C[rw4.C[,<span class="dv">2</span>]<span class="op">==</span><span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb134-16" title="16"><span class="co">#qqplot</span></a>
<a class="sourceLine" id="cb134-17" title="17"><span class="kw">qqplot</span>(r1.R, r1.C, <span class="dt">xlab =</span> <span class="st">&quot;r.R&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;r.C&quot;</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Q-Q plot of sigma=0.05&quot;</span> ))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="kw">qqplot</span>(r2.R, r2.C, <span class="dt">xlab =</span> <span class="st">&quot;r.R&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;r.C&quot;</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Q-Q plot of sigma=0.5&quot;</span>  ))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1"><span class="kw">qqplot</span>(r3.R, r3.C, <span class="dt">xlab =</span> <span class="st">&quot;r.R&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;r.C&quot;</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Q-Q plot of sigma=2&quot;</span>    ))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">qqplot</span>(r4.R, r4.C, <span class="dt">xlab =</span> <span class="st">&quot;r.R&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;r.C&quot;</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Q-Q plot of sigma=16&quot;</span>   ))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="campare-the-computation-time-of-the-two-functions-with-microbenchmark" class="section level3">
<h3>Campare the computation time of the two functions with microbenchmark</h3>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1"><span class="kw">library</span>(microbenchmark) </a>
<a class="sourceLine" id="cb138-2" title="2">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(rw1.R &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N) ,rw2.R &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N) ,rw3.R &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N) ,rw4.R &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N) ,rw1.C &lt;-<span class="st"> </span><span class="kw">randomwalkC</span>(sigma[<span class="dv">1</span>], x0, N) ,rw2.C &lt;-<span class="st"> </span><span class="kw">randomwalkC</span>(sigma[<span class="dv">2</span>], x0, N) ,rw3.C &lt;-<span class="st"> </span><span class="kw">randomwalkC</span>(sigma[<span class="dv">3</span>], x0, N)  ,rw4.C &lt;-<span class="st"> </span><span class="kw">randomwalkC</span>(sigma[<span class="dv">4</span>], x0, N))</a>
<a class="sourceLine" id="cb138-3" title="3"><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##                                      expr      lq  median      uq
## 1 rw1.R &lt;- rw.Metropolis(sigma[1], x0, N) 8084.50 8408.85 8988.10
## 2 rw2.R &lt;- rw.Metropolis(sigma[2], x0, N) 8125.25 8457.10 9369.75
## 3 rw3.R &lt;- rw.Metropolis(sigma[3], x0, N) 8124.60 8448.40 9193.90
## 4 rw4.R &lt;- rw.Metropolis(sigma[4], x0, N) 8133.45 8435.40 9116.65
## 5   rw1.C &lt;- randomwalkC(sigma[1], x0, N)  394.25  405.20  436.55
## 6   rw2.C &lt;- randomwalkC(sigma[2], x0, N)  411.45  431.00  462.75
## 7   rw3.C &lt;- randomwalkC(sigma[3], x0, N)  362.50  380.40  416.25
## 8   rw4.C &lt;- randomwalkC(sigma[4], x0, N)  258.00  267.85  288.65</code></pre>
<p>We can find that the effective random numbers generated by the R and Rcpp gradually become proportional as the variance increases. What’s more, the calculation time of Rcpp is significantly less than that of R. Thus, the Rcpp will performs better than R in this case.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
